!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jsonxml"],function(c){return b(c,a)}):"object"==typeof module&&module.exports?module.exports=function(a,c){return a||(a=window),void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(a)),require("./grid.base"),require("./jsonxml"),b(c,a),c}:b(jQuery,a)}("undefined"!=typeof window?window:this,function(a,b){"use strict";var c=a.jgrid;a.jgrid.extend({jqGridImport:function(b){return b=a.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},b||{}),this.each(function(){var d,e=this,f=function(b,d){var f,g,h,i,j=a(d.xmlGrid.config,b)[0],k=a(d.xmlGrid.data,b)[0];if(xmlJsonClass.xml2json){f=xmlJsonClass.xml2json(j," "),f=a.parseJSON(f);for(h in f)f.hasOwnProperty(h)&&(g=f[h]);void 0!==g&&(k?(i=f.grid.datatype,f.grid.datatype="xmlstring",f.grid.datastr=b,a(e).jqGrid(g).jqGrid("setGridParam",{datatype:i})):a(e).jqGrid(g))}else(null!=c.defaults&&a.isFunction(c.defaults.fatalError)?c.defaults.fatalError:alert)("xml2json or parse are not present")},g=function(b,c){if(b&&"string"==typeof b){var d,f=a.parseJSON(b),g=f[c.jsonGrid.config],h=f[c.jsonGrid.data];h?(d=g.datatype,g.datatype="jsonstring",g.datastr=h,a(e).jqGrid(g).jqGrid("setGridParam",{datatype:d})):a(e).jqGrid(g)}};switch(b.imptype){case"xml":a.ajax(a.extend({url:b.impurl,type:b.mtype,data:b.impData,dataType:"xml",context:b,complete:function(b){!(b.status<300||304===b.status)||0===b.status&&4===b.readyState||(f(b.responseXML,this),a(e).triggerHandler("jqGridImportComplete",[b,this]),a.isFunction(this.importComplete)&&this.importComplete(b))}},b.ajaxOptions));break;case"xmlstring":b.impstring&&"string"==typeof b.impstring&&(d=a.parseXML(b.impstring))&&(f(d,b),a(e).triggerHandler("jqGridImportComplete",[d,b]),a.isFunction(b.importComplete)&&b.importComplete(d),b.impstring=null);break;case"json":a.ajax(a.extend({url:b.impurl,type:b.mtype,data:b.impData,dataType:"json",context:b,complete:function(b){try{!(b.status<300||304===b.status)||0===b.status&&4===b.readyState||(g(b.responseText,this),a(e).triggerHandler("jqGridImportComplete",[b,this]),a.isFunction(this.importComplete)&&this.importComplete(b))}catch(a){}}},b.ajaxOptions));break;case"jsonstring":b.impstring&&"string"==typeof b.impstring&&(g(b.impstring,b),a(e).triggerHandler("jqGridImportComplete",[b.impstring,b]),a.isFunction(b.importComplete)&&b.importComplete(b.impstring),b.impstring=null)}})},jqGridExport:function(b){b=a.extend({exptype:"xmlstring",root:"grid",ident:"\t"},b||{});var c=null;return this.each(function(){if(this.grid){var d,e=a.extend(!0,{},a(this).jqGrid("getGridParam"));if(e.rownumbers&&(e.colNames.splice(0,1),e.colModel.splice(0,1)),e.multiselect&&(e.colNames.splice(0,1),e.colModel.splice(0,1)),e.subGrid&&(e.colNames.splice(0,1),e.colModel.splice(0,1)),e.knv=null,e.treeGrid)for(d in e.treeReader)e.treeReader.hasOwnProperty(d)&&(e.colNames.splice(e.colNames.length-1),e.colModel.splice(e.colModel.length-1));switch(b.exptype){case"xmlstring":c="<"+b.root+">"+xmlJsonClass.json2xml(e,b.ident)+"</"+b.root+">";break;case"jsonstring":c="{"+xmlJsonClass.toJson(e,b.root,b.ident,!1)+"}",void 0!==e.postData.filters&&(c=c.replace(/filters":"/,'filters":'),c=c.replace(/\}\]\}"/,"}]}"))}}}),c},excelExport:function(c){return c=a.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},c||{}),this.each(function(){var d;this.grid&&"remote"===c.exptype&&(d=a.extend({},this.p.postData,c.exportOptions),d[c.oper]=c.tag,b.location=c.url+(null!=c.url&&c.url.indexOf("?")>=0?"&":"?")+a.param(d))})}})});
//# sourceMappingURL=grid.import.js.map