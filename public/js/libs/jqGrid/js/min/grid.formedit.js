!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.common","./grid.filter"],function(c){return b(c,a,a.document)}):"object"==typeof module&&module.exports?module.exports=function(a,c){return a||(a=window),void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(a)),require("./grid.base"),require("./jquery.fmatter"),require("./grid.common"),require("./grid.filter"),b(c,a,a.document),c}:b(jQuery,a,a.document)}("undefined"!=typeof window?window:this,function(a,b,c){"use strict";var d=a.jgrid,e=d.jqID,f=a.fn.jqGrid,g=f.getGuiStyles,h=d.mergeCssClasses,i=d.hasOneFromClasses,j=d.feedback,k=d.fullBoolFeedback,l=d.builderFmButon,m=function(a,b,c){var d;b[0]===!0&&(d="<span class='"+h("fm-button-icon",c,b[2])+"'></span>","right"===b[1]?a.addClass("fm-button-icon-right").append(d):a.addClass("fm-button-icon-left").prepend(d))},n=function(a){return g.call(this,"states."+a)},o=function(b){b.find("tr[data-rowpos]").each(function(){var b=0;a(this).children("td").each(function(){"hidden"!==a(this).css("visibility")&&b++}),b||a(this).hide()})},p=function(a){return"&nbsp;"===a||"&#160;"===a||1===a.length&&160===a.charCodeAt(0)};d.extend({searchGrid:function(b){return this.each(function(){function c(b){y("beforeShow",b)&&(a(t).data("onClose",p.onClose),d.viewModal.call(i,t,{gbox:u,jqm:p.jqModal,overlay:p.overlay,modal:p.modal,overlayClass:p.overlayClass,toTop:p.toTop,onHide:function(a){a.w.remove(),a.o&&a.o.remove()}}),y("afterShow",b))}var i=this,m=a(i),o=i.p;if(i.grid&&null!=o){var p=a.extend(!0,{drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,removemodal:!0,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE",in:"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"IS NOT NULL"}},f.getGridRes.call(m,"search"),d.search||{},o.searching||{},b||{}),q="fbox_"+o.id,r=p.commonIconClass,s={themodal:"searchmod"+q,modalhead:"searchhd"+q,modalcontent:"searchcnt"+q,resizeAlso:q},t="#"+e(s.themodal),u=o.gBox,v=o.gView,w=a.each,x=o.postData[p.sFilter],y=function(){var b=a.makeArray(arguments);return b.unshift("Search"),b.unshift("Filter"),b.unshift(p),j.apply(i,b)},z=function(){d.hideModal(t,{gb:u,jqm:p.jqModal,onClose:p.onClose,removemodal:p.removemodal})};if("string"==typeof x&&(x=""!==a.trim(x)?a.parseJSON(x):void 0),a(t).remove(),void 0!==a(t)[0])c(a("#fbox_"+e(o.id)));else{var A=a("<div><div id='"+q+"' class='"+g.call(i,"dialog.body","searchFilter")+"' style='overflow:auto'></div></div>").insertBefore(v);"rtl"===o.direction&&A.attr("dir","rtl");var B,C,D="",E="",F=!1,G=-1,H=a.extend([],o.colModel),I=l.call(i,q+"_search",p.Find,h(r,p.findDialogIcon),"right"),J=l.call(i,q+"_reset",p.Reset,h(r,p.resetDialogIcon),"left");if(p.showQuery&&(D=l.call(i,q+"_query","Query",h(r,p.queryDialogIcon),"left")+"&#160;"),p.searchForAdditionalProperties&&w(o.additionalProperties,function(){var a="string"==typeof this?{name:this}:this;a.label||(a.label=a.name),a.isAddProp=!0,H.push(a)}),p.columns.length?(H=p.columns,G=0,B=H[0].index||H[0].name):w(H,function(a,b){if(b.label||(b.label=b.isAddProp?b.name:o.colNames[a]),!F){var c=void 0===b.search||b.search,d=b.hidden===!0;(b.searchoptions&&b.searchoptions.searchhidden===!0&&c||c&&!d)&&(F=!0,B=b.index||b.name,G=a)}}),!x&&B||p.multipleSearch===!1){var K="eq";G>=0&&H[G].searchoptions&&H[G].searchoptions.sopt?K=H[G].searchoptions.sopt[0]:p.sopt&&p.sopt.length&&(K=p.sopt[0]),x={groupOp:"AND",rules:[{field:B,op:K,data:""}]}}F=!1,p.tmplNames&&p.tmplNames.length&&(F=!0,E=p.tmplLabel,E+="<select class='ui-template'>",E+="<option value='default'>Default</option>",w(p.tmplNames,function(a,b){E+="<option value='"+a+"'>"+b+"</option>"}),E+="</select>"),C="<div class='"+g.call(i,"dialog.footer")+"'><table class='EditTable' style='border:0px none;margin-top:5px' id='"+q+"_2'><tbody><tr><td colspan='2'><hr class='"+g.call(i,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='EditButton EditButton-"+o.direction+"'  style='float:"+("rtl"===o.direction?"right":"left")+";'>"+J+E+"</td><td class='EditButton EditButton-"+o.direction+"'>"+D+I+"</td></tr></tbody></table></div>",q=e(q),p.gbox=u,p.height="auto",q="#"+q,a(q).jqFilter({columns:H,filter:p.loadDefaults?x:null,showQuery:p.showQuery,errorcheck:p.errorcheck,sopt:p.sopt,groupButton:p.multipleGroup,ruleButtons:p.multipleSearch,afterRedraw:p.afterRedraw,ops:p.odata,cops:o.customSortOperations,operands:p.operands,ajaxSelectOptions:o.ajaxSelectOptions,groupOps:p.groupOps,onChange:function(b,c){b.showQuery&&a(".query",c).text(c.toUserFriendlyString()),k.call(i,p.afterChange,"jqGridFilterAfterChange",a(q),p,b,c)},direction:o.direction,id:o.id}),A.append(C),F&&p.tmplFilters&&p.tmplFilters.length&&a(".ui-template",A).on("change",function(){var b=a(this).val();return"default"===b?a(q).jqFilter("addFilter",x):a(q).jqFilter("addFilter",p.tmplFilters[parseInt(b,10)]),!1}),p.multipleGroup===!0&&(p.multipleSearch=!0),y("onInitialize",a(q)),p.layer?d.createModal.call(i,s,A,p,v,a(u)[0],"#"+e(p.layer),{position:"relative"}):d.createModal.call(i,s,A,p,v,a(u)[0]),(p.searchOnEnter||p.closeOnEscape)&&a(t).keydown(function(b){var c=a(b.target);return!p.searchOnEnter||13!==b.which||c.hasClass("add-group")||c.hasClass("add-rule")||c.hasClass("delete-group")||c.hasClass("delete-rule")||c.hasClass("fm-button")&&c.is("[id$=_query]")?p.closeOnEscape&&27===b.which?(a("#"+e(s.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1):void 0:(a(q+"_search").click(),!1)}),D&&a(q+"_query").on("click",function(){return a(".queryresult",A).toggle(),!1}),void 0===p.stringResult&&(p.stringResult=p.multipleSearch),a(q+"_search").on("click",function(){var b,c={},d="",e=a(q),f=e.find(".input-elm");if(f.filter(":focus")&&(f=f.filter(":focus")),f.change(),b=e.jqFilter("filterData"),p.errorcheck&&(e[0].hideError(),p.showQuery||e.jqFilter("toSQLString"),e[0].p.error))return e[0].showError(),!1;if(p.stringResult||"local"===o.datatype){try{d=JSON.stringify(b)}catch(a){}"string"==typeof d&&(c[p.sFilter]=d,w([p.sField,p.sValue,p.sOper],function(){c[this]=""}))}else p.multipleSearch?(c[p.sFilter]=b,w([p.sField,p.sValue,p.sOper],function(){c[this]=""})):(c[p.sField]=b.rules[0].field,c[p.sValue]=b.rules[0].data,c[p.sOper]=b.rules[0].op,c[p.sFilter]="");return a.extend(o.postData,c),k.call(i,p.onSearch,"jqGridFilterSearch",o.filters)&&(o.search=!0,m.trigger("reloadGrid",[a.extend({page:1},p.reloadGridSearchOptions||{})])),p.closeAfterSearch&&z(),!1}),a(q+"_reset").on("click",function(){var b={},c=a(q);return o.search=!1,o.resetsearch=!0,p.multipleSearch===!1?b[p.sField]=b[p.sValue]=b[p.sOper]="":b[p.sFilter]="",c[0].resetFilter(),F&&a(".ui-template",A).val("default"),a.extend(o.postData,b),k.call(i,p.onReset,"jqGridFilterReset")&&m.trigger("reloadGrid",[a.extend({page:1},p.reloadGridResetOptions||{})]),p.closeAfterReset&&z(),!1}),c(a(q));var L=n.call(i,"hover");a(".fm-button:not(."+n.call(i,"disabled").split(" ").join(".")+")",A).hover(function(){a(this).addClass(L)},function(){a(this).removeClass(L)})}}})},editGridRow:function(b,c){return this.each(function(){function k(){return a(K+" > tbody > tr > td .FormElement").each(function(){var b,c,f,g,h,i,j=a(".customelement",this),k=this.name;if(j.length){if(k=j.attr("name"),void 0!==(c=Q[k])&&(b=P[c],f=b.editoptions||{},a.isFunction(f.custom_value))){try{if(A[k]=f.custom_value.call(x,a("#"+e(k),K),"get"),void 0===A[k])throw"e1"}catch(a){"e1"===a?d.info_dialog.call(x,V,"function 'custom_value' "+G.msg.novalue,G.bClose):d.info_dialog.call(x,V,a.message,G.bClose)}return!0}}else switch(i=a(this)[0].type){case"checkbox":A[k]=a(this).is(":checked")?a(this).val():a(this).data("offval");break;case"select-one":A[k]=a("option:selected",this).val();break;case"select-multiple":A[k]=a(this).val(),A[k]=A[k]?A[k].join(","):"";var l=[];a("option:selected",this).each(function(b,c){l[b]=a(c).text()});break;case"date":A[k]=a(this).val(),3===String(A[k]).split("-").length&&void 0!==(c=Q[k])&&(b=P[c],g=b.formatoptions||{},h=g.newformat||E.call(y,"formatter.date.newformat"),A[k]=d.parseDate.call(y[0],"Y-m-d",A[k],h));break;default:void 0!==i&&a.inArray(i,G.skipPostTypes)<0&&(A[k]=a(this).val())}}),!0}function q(b,c){var g,h,i,j,k,l=0;(G.checkOnSubmit||G.checkOnUpdate)&&(G._savedData={},G._savedData[D+"_id"]=b);var m=z.colModel;if("_empty"===b)return a(m).each(function(){g=this.name,i=a.extend({},this.editoptions||{}),(h=a("#"+e(g),c))&&h.length&&null!==h[0]&&(j="","custom"===this.edittype&&a.isFunction(i.custom_value)?i.custom_value.call(x,h,"set",j):i.defaultValue?(j=a.isFunction(i.defaultValue)?i.defaultValue.call(x):i.defaultValue,"checkbox"===h[0].type?(k=j.toLowerCase(),k.search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==k?(h[0].checked=!0,h[0].defaultChecked=!0,h[0].value=j):(h[0].checked=!1,h[0].defaultChecked=!1)):h.val(j)):"checkbox"===h[0].type?(h[0].checked=!1,h[0].defaultChecked=!1,j=a(h).data("offval")):h[0].type&&"select"===h[0].type.substr(0,6)?h[0].selectedIndex=0:h.val(j),(G.checkOnSubmit===!0||G.checkOnUpdate)&&(G._savedData[g]=j))}),void a("#id_g",c).val(b);var n=f.getInd.call(y,b,!0);n&&(a(n.cells).filter("td[role=gridcell]").each(function(f){var h;if("cb"!==(g=m[f].name)&&"subgrid"!==g&&"rn"!==g&&m[f].editable===!0){try{h=a.unformat.call(x,a(this),{rowId:b,colModel:m[f]},f)}catch(b){h="textarea"===m[f].edittype?a(this).text():a(this).html()}switch(z.autoEncodeOnEdit&&(h=d.oldDecodePostedData(h)),(G.checkOnSubmit===!0||G.checkOnUpdate)&&(G._savedData[g]=h),g="#"+e(g),m[f].edittype){case"password":case"text":case"button":case"image":case"textarea":p(h)&&(h=""),a(g,c).val(h);break;case"select":var i=h.split(",");i=a.map(i,function(b){return a.trim(b)}),a(g+" option",c).each(function(){var b=this,c=a(b),d=a.trim(c.val()),e=a.trim(c.text());m[f].editoptions.multiple||a.trim(h)!==e&&i[0]!==e&&i[0]!==d?m[f].editoptions.multiple&&(a.inArray(e,i)>-1||a.inArray(d,i)>-1)?b.selected=!0:b.selected=!1:b.selected=!0});break;case"checkbox":h=String(h),m[f].editoptions&&m[f].editoptions.value?h=m[f].editoptions.value.split(":")[0]===h:(h=h.toLowerCase(),h=h.search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==h),a(g,c).prop({checked:h,defaultChecked:h});break;case"custom":try{if(!m[f].editoptions||!a.isFunction(m[f].editoptions.custom_value))throw"e1";m[f].editoptions.custom_value.call(x,a(g,c),"set",h)}catch(a){"e1"===a?d.info_dialog.call(x,V,"function 'custom_value' "+G.msg.nodefined,G.bClose):d.info_dialog.call(x,V,a.message,G.bClose)}}l++}}),l>0&&a("#id_g",K).val(b))}function r(){var b=G.url||z.editurl;a.each(P,function(c,d){var e=d.name,f=A[e];"date"!==d.formatter||null!=d.formatoptions&&d.formatoptions.sendFormatted===!0||(A[e]=a.unformat.date.call(x,f,d)),"clientArray"!==b&&d.editoptions&&d.editoptions.NullIfEmpty===!0&&A.hasOwnProperty(e)&&""===f&&(A[e]="null")})}function s(){var c,e,g,h,i,j,k,l,m=[!0,"",""],n=m,o={},p=z.prmNames,s=f.getInd.call(y,b),t=s===!1?null:x.rows[s],u=y.triggerHandler("jqGridAddEditBeforeCheckValues",[A,a(H),C]);u&&"object"==typeof u&&(A=u),s=s===!1?-1:s,a.isFunction(G.beforeCheckValues)&&(u=G.beforeCheckValues.call(x,A,a(H),C))&&"object"==typeof u&&(A=u);for(g in A)if(A.hasOwnProperty(g)&&(l=z.iColByName[g],n=d.checkValues.call(x,A[g],g,void 0,void 0,{oldValue:"_empty"===b?null:f.getCell.call(y,b,l),newValue:A[g],cmName:g,rowid:b,cm:P[l],iCol:l,iRow:s,tr:t,td:null==t?null:t.cells[l],mode:"_empty"===b?"addForm":"editForm"}),null!=n&&n!==!0||(n=m),n[0]===!1))break;if(r(),n[0]&&(o=y.triggerHandler("jqGridAddEditClickSubmit",[G,A,C]),void 0===o&&a.isFunction(G.onclickSubmit)&&(o=G.onclickSubmit.call(x,G,A,C)||{}),n=y.triggerHandler("jqGridAddEditBeforeSubmit",[A,a(H),C]),null!=n&&n!==!0||(n=m),n[0]&&a.isFunction(G.beforeSubmit)&&(null!=(n=G.beforeSubmit.call(x,A,a(H),C))&&n!==!0||(n=m))),n[0]&&!G.processing){if(G.processing=!0,a("#sData",L).addClass($),j=G.url||z.editurl,e=p.oper,c="clientArray"===j&&z.keyName!==!1?z.keyName:p.id,A[e]="_empty"===a.trim(A[D+"_id"])?p.addoper:p.editoper,A[e]!==p.addoper?A[c]=A[D+"_id"]:void 0===A[c]&&(A[c]=A[D+"_id"]),delete A[D+"_id"],A=a.extend(A,G.editData,o),z.treeGrid===!0){if(A[e]===p.addoper){h=z.selrow;A["adjacency"===z.treeGridModel?z.treeReader.parent_id_field:"parent_id"]=h}for(i in z.treeReader)if(z.treeReader.hasOwnProperty(i)&&(k=z.treeReader[i],A.hasOwnProperty(k))){if(A[e]===p.addoper&&"parent_id_field"===i)continue;delete A[k]}}A[c]=d.stripPref(z.idPrefix,A[c]),z.autoEncodeOnEdit&&a.each(A,function(b,c){a.isFunction(c)||(A[b]=d.oldEncodePostedData(c))});var v=a.extend({url:a.isFunction(j)?j.call(x,A[c],C,A,G):j,type:a.isFunction(G.mtype)?G.mtype.call(x,C,G,A[c],A):G.mtype,data:d.serializeFeedback.call(x,a.isFunction(G.serializeEditData)?G.serializeEditData:z.serializeEditData,"jqGridAddEditSerializeEditData",A),complete:function(b,g){if(y.jqGrid("progressBar",{method:"hide",loadtype:G.saveui}),a("#sData",L).removeClass($),A[c]=a("#id_g",K).val(),b.status>=300&&304!==b.status||0===b.status&&4===b.readyState?(n[0]=!1,n[1]=y.triggerHandler("jqGridAddEditErrorTextFormat",[b,C]),a.isFunction(G.errorTextFormat)?n[1]=G.errorTextFormat.call(x,b,C):n[1]=g+" Status: '"+b.statusText+"'. Error code: "+b.status):(n=y.triggerHandler("jqGridAddEditAfterSubmit",[b,A,C]),null!=n&&n!==!0||(n=m),n[0]&&a.isFunction(G.afterSubmit)&&(null!=(n=G.afterSubmit.call(x,b,A,C))&&n!==!0||(n=m))),n[0]===!1)a("#FormError>td",K).html(n[1]),a("#FormError",K).show();else{z.autoEncodeOnEdit&&a.each(A,function(a,b){A[a]=d.oldDecodePostedData(b)});var i=[a.extend({},G.reloadGridOptions||{})];if(A[e]===p.addoper?(n[2]||(n[2]=d.randId()),null==A[c]||"_empty"===A[c]||A[e]===p.addoper?A[c]=n[2]:n[2]=A[c],G.reloadAfterSubmit?y.trigger("reloadGrid",i):z.treeGrid===!0?f.addChildNode.call(y,n[2],h,A):f.addRowData.call(y,n[2],A,G.addedrow),G.closeAfterAdd?(z.treeGrid!==!0&&F.call(y,n[2]),U()):G.clearAfterAdd&&q("_empty",H)):(G.reloadAfterSubmit?(y.trigger("reloadGrid",i),G.closeAfterEdit||setTimeout(function(){F.call(y,A[c])},1e3)):z.treeGrid===!0?f.setTreeRow.call(y,A[c],A):f.setRowData.call(y,A[c],A),G.closeAfterEdit&&U()),a.isFunction(G.afterComplete)){var j=b;setTimeout(function(){y.triggerHandler("jqGridAddEditAfterComplete",[j,A,a(H),C]),G.afterComplete.call(x,j,A,a(H),C),j=null},50)}if((G.checkOnSubmit||G.checkOnUpdate)&&(a(H).data("disabled",!1),"_empty"!==G._savedData[D+"_id"])){var k;for(k in G._savedData)G._savedData.hasOwnProperty(k)&&A[k]&&(G._savedData[k]=A[k])}}G.processing=!1;try{a(H).find("input,textarea,select,button,object,*[tabindex]").filter(":input:visible:not(:disabled)").first().focus()}catch(a){}}},d.ajaxOptions,G.ajaxEditOptions);if(v.url||G.useDataProxy||(a.isFunction(z.dataProxy)?G.useDataProxy=!0:(n[0]=!1,n[1]+=" "+d.errors.nourl)),n[0])if(y.jqGrid("progressBar",{method:"show",loadtype:G.saveui,htmlcontent:G.savetext}),G.useDataProxy){var w=z.dataProxy.call(x,v,"set_"+D);void 0===w&&(w=[!0,""]),w[0]===!1?(n[0]=!1,n[1]=w[1]||"Error deleting the selected row!"):(v.data.oper===p.addoper&&G.closeAfterAdd&&U(),v.data.oper===p.editoper&&G.closeAfterEdit&&U())}else"clientArray"===v.url?(G.reloadAfterSubmit=!1,A=v.data,v.complete({status:200,statusText:""},"")):a.ajax(v)}n[0]===!1&&(a("#FormError>td",K).html(n[1]),a("#FormError",K).show())}function t(a,b){var c,d=!1;for(c in a)if(a.hasOwnProperty(c)&&String(a[c])!==String(b[c])){d=!0;break}return d}function u(){var b=!0;return a("#FormError",K).hide(),G.checkOnUpdate&&(A={},k(),(B=t(A,G._savedData))&&(a(H).data("disabled",!0),a(".confirm",N).show(),b=!1)),b}function v(b,c){var d=c[1].length-1;0===b?a("#pData",L).addClass(Y):void 0!==c[1][b-1]&&i(a("#"+e(c[1][b-1])),Y)?a("#pData",L).addClass(Y):a("#pData",L).removeClass(Y),b===d?a("#nData",L).addClass(Y):void 0!==c[1][b+1]&&i(a("#"+e(c[1][b+1])),Y)?a("#nData",L).addClass(Y):a("#nData",L).removeClass(Y)}function w(){var b=f.getDataIDs.call(y),c=a("#id_g",K).val();return[a.inArray(c,b),b]}var x=this,y=a(x),z=x.p;if(x.grid&&null!=z&&b){var A,B,C,D=z.id,E=f.getGridRes,F=f.setSelection,G=a.extend(!0,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:g.call(this,"overlay"),removemodal:!0,skipPostTypes:["image","file"],saveui:"enable",savetext:E.call(y,"defaults.savetext")||"Saving..."},E.call(y,"edit"),d.edit,z.formEditing||{},c||{}),H="FrmGrid_"+D,I=H,J="TblGrid_"+D,K="#"+e(J),L=K+"_2",M={themodal:"editmod"+D,modalhead:"edithd"+D,modalcontent:"editcnt"+D,resizeAlso:H},N="#"+e(M.themodal),O=z.gBox,P=z.colModel,Q=z.iColByName,R=1,S=0,T=G.commonIconClass,U=function(){d.hideModal(N,{gb:O,jqm:G.jqModal,onClose:G.onClose,removemodal:G.removemodal})},V=E.call(y,"errors.errcap"),W=function(){var b=a.makeArray(arguments);return b.unshift(""),b.unshift("AddEdit"),b.unshift(G),j.apply(x,b)},X=n.call(x,"hover"),Y=n.call(x,"disabled"),Z=n.call(x,"select"),$=n.call(x,"active"),_=n.call(x,"error");a(N).remove(),H="#"+e(H),"new"===b?(b="_empty",C="add",G.caption=G.addCaption):(G.caption=G.editCaption,C="edit");var aa=!0;!G.checkOnUpdate||G.jqModal!==!0&&void 0!==G.jqModal||G.modal||(aa=!1);var ba=isNaN(G.dataheight)?G.dataheight:G.dataheight+"px",ca=isNaN(G.datawidth)?G.datawidth:G.datawidth+"px",da=a("<form name='FormPost' id='"+I+"' class='FormGrid' onSubmit='return false;' style='width:"+ca+";overflow:auto;position:relative;height:"+ba+";'></form>").data("disabled",!1),ea=a("<table id='"+J+"' class='EditTable'><tbody></tbody></table>");a(P).each(function(){var a=this.formoptions;R=Math.max(R,a?a.colpos||0:0),S=Math.max(S,a?a.rowpos||0:0)}),a(da).append(ea);var fa=a("<tr id='FormError' style='display:none'><td class='"+_+"' colspan='"+2*R+"'>&#160;</td></tr>");if(fa[0].rp=0,a(ea).append(fa),fa=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*R+"'>"+(G.topinfo||"&#160;")+"</td></tr>"),fa[0].rp=0,a(ea).append(fa),W("beforeInitData",da,C)){!function(){var c=d.detectRowEditing.call(x,b);if(null!=c)if("inlineEditing"===c.mode)f.restoreRow.call(y,b);else{var e=c.savedRow,g=x.rows[e.id];f.restoreCell.call(y,e.id,e.ic),a(g.cells[e.ic]).removeClass("edit-cell "+Z),a(g).addClass(Z).attr({"aria-selected":"true",tabindex:"0"})}}();var ga="rtl"===z.direction,ha=ga?"nData":"pData",ia=ga?"pData":"nData";!function(b,c,h){var i,j=0,k=[],l=!1,m=a(c),n="";for(i=1;i<=h;i++)n+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";if("_empty"!==b&&(l=f.getInd.call(y,b)),a(P).each(function(c){var f,i,o,q,r,s=this,t=s.name,u=s.editable,v=!1,w=!1,y="_empty"===b?"addForm":"editForm";switch(a.isFunction(u)&&(u=u.call(x,{rowid:b,iCol:c,iRow:l,cmName:t,cm:s,mode:y})),i=!(s.editrules&&s.editrules.edithidden===!0||s.hidden!==!0&&"hidden"!==u),String(u).toLowerCase()){case"hidden":u=!0;break;case"disabled":u=!0,v=!0;break;case"readonly":u=!0,w=!0}if("cb"!==t&&"subgrid"!==t&&u===!0&&"rn"!==t){if(l===!1)q="";else{f=a(x.rows[l].cells[c]);try{q=a.unformat.call(x,f,{rowId:b,colModel:s},c)}catch(a){q=s.edittype&&"textarea"===s.edittype?f.text():f.html()}p(q)&&(q="")}var A=a.extend({},s.editoptions||{},{id:t,name:t,rowId:b,mode:y,cm:s,iCol:c}),B=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},s.formoptions||{}),C=parseInt(B.rowpos,10)||j+1,D=parseInt(2*(parseInt(B.colpos,10)||1),10);if("_empty"===b&&A.defaultValue&&(q=a.isFunction(A.defaultValue)?A.defaultValue.call(x):A.defaultValue),s.edittype||(s.edittype="text"),z.autoEncodeOnEdit&&(q=d.oldDecodePostedData(q)),r=d.createEl.call(x,s.edittype,A,q,!1,a.extend({},d.ajaxOptions,z.ajaxSelectOptions||{})),(G.checkOnSubmit||G.checkOnUpdate)&&(G._savedData[t]=q),a(r).addClass("FormElement"),a.inArray(s.edittype,["text","textarea","checkbox","password","select"])>-1&&a(r).addClass(g.call(x,"dialog.dataField")),o=m.find("tr[data-rowpos="+C+"]"),B.rowabove){var E=a("<tr><td class='contentinfo' colspan='"+2*h+"'>"+B.rowcontent+"</td></tr>");m.append(E),E[0].rp=C}0===o.length&&(o=a("<tr data-rowpos='"+C+"'></tr>").addClass("FormData").attr("id","tr_"+t),a(o).append(n),m.append(o),o[0].rp=C);var F=a("td:eq("+(D-2)+")",o[0]),I=a("td:eq("+(D-1)+")",o[0]);F.html(void 0===B.label?z.colNames[c]:B.label||"&#160;"),I[p(I.html())?"html":"append"](B.elmprefix).append(r).append(B.elmsuffix),v?(F.addClass(Y),I.addClass(Y),a(r).prop("readonly",!0),a(r).prop("disabled",!0)):w&&a(r).prop("readonly",!0),"custom"===s.edittype&&a.isFunction(A.custom_value)&&A.custom_value.call(x,a("#"+e(t),H),"set",q),d.bindEv.call(x,r,A),i&&F.add(I).css("visibility","hidden"),k[j]=c,j++}}),o(m),j>0){var q=a("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*h-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+D+"_id' value='"+b+"'/></td></tr>");q[0].rp=j+999,m.append(q),(G.checkOnSubmit||G.checkOnUpdate)&&(G._savedData[D+"_id"]=b)}k}(b,ea,R);var ja=l.call(x,ha,"",h(T,G.prevIcon),"","left"),ka=l.call(x,ia,"",h(T,G.nextIcon),"","right"),la=l.call(x,"sData",G.bSubmit),ma=l.call(x,"cData",G.bCancel),na="<div class='"+g.call(x,"dialog.footer")+"'><table class='EditTable' id='"+J+"_2'><tbody><tr><td colspan='2'><hr class='"+g.call(x,"dialog.hr")+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton navButton-"+z.direction+"'>"+(ga?ka+ja:ja+ka)+"</td><td class='EditButton EditButton-"+z.direction+"'>"+la+"&#160;"+ma+"</td></tr>";if(na+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+(G.bottominfo||"&#160;")+"</td></tr>",na+="</tbody></table></div>",S>0){var oa=[];a.each(a(ea)[0].rows,function(a,b){oa[a]=b}),oa.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0}),a.each(oa,function(b,c){a("tbody",ea).append(c)})}G.gbox=O;var pa=!1;G.closeOnEscape===!0&&(G.closeOnEscape=!1,pa=!0);var qa=a("<div></div>").append(a("<div class='"+g.call(x,"dialog.body")+"'></div>").append(da)).append(na);if(d.createModal.call(x,M,qa,G,z.gView,a(O)[0]),G.topinfo&&a(".tinfo",K).show(),G.bottominfo&&a(".binfo",L).show(),qa=null,na=null,a(N).keydown(function(b){var c,d,e=(b.target.tagName||"").toUpperCase();if(a(H).data("disabled")===!0)return!1;if(13===b.which&&"TEXTAREA"!==e){if(c=a(L).find(":focus"),d=c.attr("id"),c.length>0&&a.inArray(d,["pData","nData","cData"])>=0)return c.trigger("click"),!1;if(G.savekey[0]===!0&&13===G.savekey[1])return a("#sData",L).trigger("click"),!1}if(G.savekey[0]===!0&&b.which===G.savekey[1]&&"TEXTAREA"!==e)return a("#sData",L).trigger("click"),!1;if(27===b.which)return!!u()&&(pa&&U(),!1);if(G.navkeys[0]===!0){if("_empty"===a("#id_g",K).val())return!0;if(b.which===G.navkeys[1])return a("#pData",L).trigger("click"),!1;if(b.which===G.navkeys[2])return a("#nData",L).trigger("click"),!1}}),G.checkOnUpdate&&(a("a.ui-jqdialog-titlebar-close span",N).removeClass("jqmClose"),a("a.ui-jqdialog-titlebar-close",N).off("click").click(function(){return!!u()&&(U(),!1)})),m(a("#sData",L),G.saveicon,T),m(a("#cData",L),G.closeicon,T),G.checkOnSubmit||G.checkOnUpdate){la=l.call(x,"sNew",G.bYes),ka=l.call(x,"nNew",G.bNo),ma=l.call(x,"cNew",G.bExit);var ra=G.zIndex||999;ra++,a("<div class='"+G.overlayClass+" jqgrid-overlay confirm' style='z-index:"+ra+";display:none;'>&#160;</div><div class='"+g.call(x,"dialog.content","confirm ui-jqconfirm")+"' style='z-index:"+(ra+1)+"'>"+G.saveData+"<br/><br/>"+la+ka+ma+"</div>").insertAfter(H),a("#sNew",N).click(function(){return s(),a(H).data("disabled",!1),a(".confirm",N).hide(),!1}),a("#nNew",N).click(function(){return a(".confirm",N).hide(),a(H).data("disabled",!1),setTimeout(function(){a(H).find("input,textarea,select,button,object,*[tabindex]").filter(":input:visible:not(:disabled)").first().focus()},0),!1}),a("#cNew",N).click(function(){return a(".confirm",N).hide(),a(H).data("disabled",!1),U(),!1})}W("onInitializeForm",a(H),C),"_empty"!==b&&G.viewPagerButtons?a("#pData,#nData",L).show():a("#pData,#nData",L).hide(),W("beforeShowForm",a(H),C),a(N).data("onClose",G.onClose),d.viewModal.call(x,N,{gbox:O,jqm:G.jqModal,overlay:G.overlay,modal:G.modal,overlayClass:G.overlayClass,toTop:G.toTop,onHide:function(a){a.w.remove(),a.o&&a.o.remove()}}),aa||a("."+e(G.overlayClass)).click(function(){return!!u()&&(U(),!1)}),a(".fm-button",N).hover(function(){a(this).addClass(X)},function(){a(this).removeClass(X)}),a("#sData",L).click(function(){return A={},a("#FormError",K).hide(),k(),"_empty"===A[D+"_id"]?s():G.checkOnSubmit===!0?(B=t(A,G._savedData),B?(a(H).data("disabled",!0),a(".confirm",N).show()):s()):s(),!1}),a("#cData",L).click(function(){return!!u()&&(U(),!1)}),a("#nData",L).click(function(){if(!u())return!1;a("#FormError",K).hide();var b=w();if(b[0]=parseInt(b[0],10),b[0]!==-1&&b[1][b[0]+1]){if(!W("onclickPgButtons","next",a(H),b[1][b[0]]))return!1;q(b[1][b[0]+1],H),F.call(y,b[1][b[0]+1]),W("afterclickPgButtons","next",a(H),b[1][b[0]+1]),v(b[0]+1,b)}return!1}),a("#pData",L).click(function(){if(!u())return!1;a("#FormError",K).hide();var b=w();if(b[0]!==-1&&b[1][b[0]-1]){if(!W("onclickPgButtons","prev",a(H),b[1][b[0]]))return!1;if(i(a("#"+e(b[1][b[0]-1])),Y))return!1;q(b[1][b[0]-1],H),F.call(y,b[1][b[0]-1]),W("afterclickPgButtons","prev",a(H),b[1][b[0]-1]),v(b[0]-1,b)}return!1}),W("afterShowForm",a(H),C);var sa=w();v(sa[0],sa)}}})},viewGridRow:function(b,c){return this.each(function(){function k(){x.closeOnEscape!==!0&&x.navkeys[0]!==!0||setTimeout(function(){a("#cData").focus()},0)}function q(b){var c,g,h=0,i=f.getInd.call(u,b,!0);i&&(a("td",i).each(function(b){g=H[b],"cb"!==(c=g.name)&&"subgrid"!==c&&"rn"!==c&&(c=e("v_"+c),a("#"+c+" span",z).html(d.getDataFieldOfCell.call(t,i,b).html()),h++)}),h>0&&a("#id_g",z).val(b))}function r(b,c){var d=c[1].length-1;0===b?a("#pData",A).addClass(N):void 0!==c[1][b-1]&&i(a("#"+e(c[1][b-1])),N)?a("#pData",A).addClass(N):a("#pData",A).removeClass(N),b===d?a("#nData",A).addClass(N):void 0!==c[1][b+1]&&i(a("#"+e(c[1][b+1])),N)?a("#nData",A).addClass(N):a("#nData",A).removeClass(N)}function s(){var b=f.getDataIDs.call(u),c=a("#id_g",z).val();return[a.inArray(c,b),b]}var t=this,u=a(t),v=t.p;if(t.grid&&null!=v&&b){var w=v.id,x=a.extend(!0,{top:0,left:0,width:0,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,closeOnEscape:!1,labelswidth:"",navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,removemodal:!0},f.getGridRes.call(u,"view"),d.view||{},v.formViewing||{},c||{}),y="#ViewGrid_"+e(w),z="#ViewTbl_"+e(w),A=z+"_2",B="ViewGrid_"+w,C="ViewTbl_"+w,D=x.commonIconClass,E={themodal:"viewmod"+w,modalhead:"viewhd"+w,modalcontent:"viewcnt"+w,resizeAlso:B},F="#"+e(E.themodal),G=v.gBox,H=v.colModel,I=1,J=0,K=function(){var b=a.makeArray(arguments);return b.unshift(""),b.unshift("View"),b.unshift(x),j.apply(t,b)},L=function(){d.hideModal(F,{gb:G,jqm:x.jqModal,onClose:x.onClose,removemodal:x.removemodal})},M=n.call(t,"hover"),N=n.call(t,"disabled"),O=isNaN(x.dataheight)?x.dataheight:x.dataheight+"px",P=isNaN(x.datawidth)?x.datawidth:x.datawidth+"px",Q=a("<div class='"+g.call(t,"dialog.body")+"'><form name='FormPost' id='"+B+"' class='FormGrid' style='width:"+P+";overflow:auto;position:relative;height:"+O+";'></form></div>"),R=Q.children("form.FormGrid"),S=a("<table id='"+C+"' class='EditTable'><tbody></tbody></table>");if(a(F).remove(),a(H).each(function(){var a=this.formoptions;I=Math.max(I,a?a.colpos||0:0),J=Math.max(J,a?a.rowpos||0:0)}),R.append(S),K("beforeInitData",R)){!function(b,c,e){var h,i,j,k,l,m,n,q,r=0,s=[],w=f.getInd.call(u,b),y=g.call(t,"dialog.viewData"),z=a(c),A=g.call(t,"dialog.viewLabel"),B=String(x.labelswidth)+(!x.labelswidth||isNaN(x.labelswidth)?"":"px"),C="<td class='"+g.call(t,"dialog.viewCellLabel","CaptionTD form-view-label")+(B?"' style='width:"+B+";":"")+"'>&#160;</td><td class='"+g.call(t,"dialog.viewCellData","DataTD form-view-data")+"'>&#160;</td>",D="",E=["integer","number","currency"],F=0,G=0;for(l=0;l<e;l++)D+=C;if(a(H).each(function(){var b=this;(i=(!b.editrules||b.editrules.edithidden!==!0)&&b.hidden===!0)||"right"!==b.align||(b.formatter&&a.inArray(b.formatter,E)!==-1?F=Math.max(F,parseInt(b.width,10)):G=Math.max(G,parseInt(b.width,10)))}),m=0!==F?F:0!==G?G:0,a(H).each(function(b){var c=this;if(h=c.name,n=!1,i=(!c.editrules||c.editrules.edithidden!==!0)&&c.hidden===!0,q="boolean"!=typeof c.viewable||c.viewable,"cb"!==h&&"subgrid"!==h&&"rn"!==h&&q){k=w===!1?"":d.getDataFieldOfCell.call(t,t.rows[w],b).html(),n="right"===c.align&&0!==m;var f=a.extend({},{rowabove:!1,rowcontent:""},c.formoptions||{}),g=parseInt(f.rowpos,10)||r+1,l=parseInt(2*(parseInt(f.colpos,10)||1),10);if(f.rowabove){var o=a("<tr><td class='contentinfo' colspan='"+2*e+"'>"+f.rowcontent+"</td></tr>");z.append(o),o[0].rp=g}j=z.find("tr[data-rowpos="+g+"]"),0===j.length&&(j=a("<tr data-rowpos='"+g+"'></tr>").addClass("FormData").attr("id","trv_"+h),j.append(D),z.append(j),j[0].rp=g);var u=void 0===f.label?v.colNames[b]:f.label,x=a("td:eq("+(l-1)+")",j[0]),B=a("td:eq("+(l-2)+")",j[0]);B.html("<label for='"+h+"'"+(A?" class='"+A+"'>":">")+(u||"&nbsp;")+"</label>"),x[p(x.html())?"html":"append"]("<span id='"+h+"'"+(y?" class='"+y+"'>":">")+(k||"&nbsp;")+"</span>").attr("id","v_"+h),n&&a("td:eq("+(l-1)+") span",j[0]).css({"text-align":"right",width:m+"px"}),i&&B.add(x).css("visibility","hidden"),s[r]=b,r++}}),o(z),r>0){var I=a("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*e-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+b+"'/></td></tr>");I[0].rp=r+99,z.append(I)}s}(b,S,I);var T="rtl"===v.direction,U=T?"nData":"pData",V=T?"pData":"nData",W=l.call(t,U,"",h(D,x.prevIcon),"","left"),X=l.call(t,V,"",h(D,x.nextIcon),"","right"),Y=l.call(t,"cData",x.bClose);if(J>0){var Z=[];a.each(a(S)[0].rows,function(a,b){Z[a]=b}),Z.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0}),a.each(Z,function(b,c){a("tbody",S).append(c)})}x.gbox=G;var $=a("<div></div>").append(Q).append("<div class='"+g.call(t,"dialog.footer")+"'><table border='0' class='EditTable' id='"+C+"_2'><tbody><tr id='Act_Buttons'><td class='navButton navButton-"+v.direction+"' width='"+(x.labelswidth||"auto")+"'>"+(T?X+W:W+X)+"</td><td class='EditButton EditButton-"+v.direction+"'>"+Y+"</td></tr></tbody></table></div>");d.createModal.call(t,E,$,x,v.gView,a(v.gView)[0]),x.viewPagerButtons||a("#pData, #nData",A).hide(),$=null,a(F).keydown(function(b){var c,d;if(a(y).data("disabled")===!0)return!1;if(13===b.which&&(c=a(A).find(":focus"),d=c.attr("id"),c.length>0&&a.inArray(d,["pData","nData","cData"])>=0))return c.trigger("click"),!1;if(27===b.which)return x.closeOnEscape&&L(),!1;if(x.navkeys[0]===!0){if(b.which===x.navkeys[1])return a("#pData",A).trigger("click"),!1;if(b.which===x.navkeys[2])return a("#nData",A).trigger("click"),!1}}),m(a("#cData",A),x.closeicon,D),K("beforeShowForm",a(y)),d.viewModal.call(t,F,{gbox:G,jqm:x.jqModal,overlay:x.overlay,toTop:x.toTop,modal:x.modal,onHide:function(a){a.w.remove(),a.o&&a.o.remove()}}),a(".fm-button:not(."+N.split(" ").join(".")+")",A).hover(function(){a(this).addClass(M)},function(){
a(this).removeClass(M)}),k(),a("#cData",A).click(function(){return L(),!1}),a("#nData",A).click(function(){a("#FormError",z).hide();var b=s();if(b[0]=parseInt(b[0],10),b[0]!==-1&&b[1][b[0]+1]){if(!K("onclickPgButtons","next",a(y),b[1][b[0]]))return!1;q(b[1][b[0]+1]),f.setSelection.call(u,b[1][b[0]+1]),K("afterclickPgButtons","next",a(y),b[1][b[0]+1]),r(b[0]+1,b)}return k(),!1}),a("#pData",A).click(function(){a("#FormError",z).hide();var b=s();if(b[0]!==-1&&b[1][b[0]-1]){if(!K("onclickPgButtons","prev",a(y),b[1][b[0]]))return!1;q(b[1][b[0]-1]),f.setSelection.call(u,b[1][b[0]-1]),K("afterclickPgButtons","prev",a(y),b[1][b[0]-1]),r(b[0]-1,b)}return k(),!1});var _=s();r(_[0],_)}}})},delGridRow:function(b,c){return this.each(function(){var h=this,i=h.p,k=a(h);if(h.grid&&null!=i&&b){var o,p,q,r,s=i.id,t=a.extend(!0,{top:0,left:0,width:240,removemodal:!0,height:"auto",dataheight:"auto",datawidth:"auto",drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,closeOnEscape:!1,delData:{},onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},f.getGridRes.call(k,"del"),d.del||{},i.formDeleting||{},c||{}),u="DelTbl_"+s,v="#DelTbl_"+e(s),w={themodal:"delmod"+s,modalhead:"delhd"+s,modalcontent:"delcnt"+s,resizeAlso:u},x="#"+e(w.themodal),y=i.gBox,z=t.commonIconClass,A=function(){var b=a.makeArray(arguments);return b.unshift(""),b.unshift("Delete"),b.unshift(t),j.apply(h,b)},B=n.call(h,"hover"),C=n.call(h,"active"),D=n.call(h,"error");if(a.isArray(b)||(b=[String(b)]),void 0!==a(x)[0]){if(!A("beforeInitData",a(v)))return;a("#DelData>td",v).text(b.join()).data("rowids",b),a("#DelError",v).hide(),t.processing===!0&&(t.processing=!1,a("#dData",v).removeClass(C)),A("beforeShowForm",a(v)),d.viewModal.call(h,x,{gbox:y,jqm:t.jqModal,jqM:!1,overlay:t.overlay,toTop:t.toTop,modal:t.modal}),A("afterShowForm",a(v))}else{var E=isNaN(t.dataheight)?t.dataheight:t.dataheight+"px",F=isNaN(t.datawidth)?t.datawidth:t.datawidth+"px",G="<div class='"+g.call(h,"dialog.body")+"'><div id='"+u+"' class='formdata' style='width:"+F+";overflow:auto;position:relative;height:"+E+";'>";G+="<table class='DelTable'><tbody>",G+="<tr id='DelError' style='display:none'><td class='"+D+"'></td></tr>",G+="<tr id='DelData' style='display:none'><td >"+b.join()+"</td></tr>",G+="<tr><td class='delmsg'>"+t.msg+"</td></tr>",G+="</tbody></table></div></div>";var H=l.call(h,"dData",t.bSubmit),I=l.call(h,"eData",t.bCancel);if(G+="<div class='"+g.call(h,"dialog.footer")+"'><table class='EditTable' id='"+u+"_2'><tbody><tr><td><hr class='"+g.call(h,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton EditButton-"+i.direction+"'>"+H+"&#160;"+I+"</td></tr></tbody></table></div>",t.gbox=y,d.createModal.call(h,w,G,t,i.gView,a(i.gView)[0]),a("#DelData>td",v).data("rowids",b),!A("beforeInitData",a(G)))return;a(".fm-button",v+"_2").hover(function(){a(this).addClass(B)},function(){a(this).removeClass(B)}),m(a("#dData",v+"_2"),t.delicon,z),m(a("#eData",v+"_2"),t.cancelicon,z),a("#dData",v+"_2").click(function(){var b,c=[!0,""],e=a("#DelData>td",v),g=e.text(),j=e.data("rowids"),l={};if(a.isFunction(t.onclickSubmit)&&(l=t.onclickSubmit.call(h,t,g)||{}),a.isFunction(t.beforeSubmit)&&(c=t.beforeSubmit.call(h,g)||c),c[0]&&!t.processing){if(t.processing=!0,q=i.prmNames,o=a.extend({},t.delData,l),r=q.oper,o[r]=q.deloper,p=q.id,g=j.slice(),!g.length)return!1;for(b in g)g.hasOwnProperty(b)&&(g[b]=d.stripPref(i.idPrefix,g[b]));o[p]=g.join(),a(this).addClass(C);var m=t.url||i.editurl,n=a.extend({url:a.isFunction(m)?m.call(h,o[p],o,t):m,type:t.mtype,data:a.isFunction(t.serializeDelData)?t.serializeDelData.call(h,o):o,complete:function(b,e){var l;if(a("#dData",v+"_2").removeClass(C),b.status>=300&&304!==b.status||0===b.status&&4===b.readyState?(c[0]=!1,a.isFunction(t.errorTextFormat)?c[1]=t.errorTextFormat.call(h,b):c[1]=e+" Status: '"+b.statusText+"'. Error code: "+b.status):a.isFunction(t.afterSubmit)&&(c=t.afterSubmit.call(h,b,o)||[!0]),c[0]===!1)a("#DelError>td",v).html(c[1]),a("#DelError",v).show();else{if("local"===i.datatype||i.treeGrid===!0||!t.reloadAfterSubmit)if(i.treeGrid===!0)try{f.delTreeNode.call(k,j[0])}catch(a){}else for(j=j.slice(),l=0;l<j.length;l++)f.delRowData.call(k,j[l]);t.reloadAfterSubmit&&k.trigger("reloadGrid",[a.extend({},t.reloadGridOptions||{})]),setTimeout(function(){A("afterComplete",b,g,a(v))},50)}t.processing=!1,c[0]&&d.hideModal(x,{gb:y,jqm:t.jqModal,onClose:t.onClose,removemodal:t.removemodal})}},d.ajaxOptions,t.ajaxDelOptions);if(n.url||t.useDataProxy||(a.isFunction(i.dataProxy)?t.useDataProxy=!0:(c[0]=!1,c[1]+=" "+d.errors.nourl)),c[0])if(t.useDataProxy){var u=i.dataProxy.call(h,n,"del_"+s);void 0===u&&(u=[!0,""]),u[0]===!1?(c[0]=!1,c[1]=u[1]||"Error deleting the selected row!"):d.hideModal(x,{gb:y,jqm:t.jqModal,onClose:t.onClose,removemodal:t.removemodal})}else"clientArray"===n.url?(o=n.data,n.complete({status:200,statusText:""},"")):a.ajax(n)}return c[0]===!1&&(a("#DelError>td",v).html(c[1]),a("#DelError",v).show()),!1}),a("#eData",v+"_2").click(function(){return d.hideModal(x,{gb:y,jqm:t.jqModal,onClose:t.onClose,removemodal:t.removemodal}),!1}),A("beforeShowForm",a(v)),d.viewModal.call(h,x,{gbox:y,jqm:t.jqModal,overlay:t.overlay,toTop:t.toTop,modal:t.modal}),A("afterShowForm",a(v))}t.closeOnEscape===!0&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+e(w.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(j,k,l,m,o,p,q){return"object"==typeof j&&(q=p,p=o,o=m,m=l,l=k,k=j,j=void 0),m=m||{},l=l||{},q=q||{},o=o||{},p=p||{},this.each(function(){var r=this,s=r.p,t=a(r);if(r.grid&&null!=s&&!(r.nav&&a(j).find(".navtable").length>0)){var u=s.id,v=a.extend({edit:!0,add:!0,del:!0,search:!0,refresh:!0,refreshstate:"firstpage",view:!1,closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,hideEmptyPagerParts:!0,alertwidth:200,alertheight:"auto",alerttop:null,removemodal:!0,alertleft:null,alertzIndex:null,iconsOverText:!1},f.getGridRes.call(t,"nav"),d.nav||{},s.navOptions||{},k||{});v.position=v.position||("rtl"===s.direction?"right":"left");var w,x,y,z=s.idSel,A=s.gBox,B=v.commonIconClass,C={themodal:"alertmod_"+u,modalhead:"alerthd_"+u,modalcontent:"alertcnt_"+u},D=function(){return function(){var f=c.documentElement,h=b,i=1024,j=768,k=t.closest(".ui-jqgrid").offset();void 0===a("#"+e(C.themodal))[0]&&(v.alerttop||v.alertleft||(void 0!==h.innerWidth?(i=h.innerWidth,j=h.innerHeight):null!=f&&void 0!==f.clientWidth&&0!==f.clientWidth&&(i=f.clientWidth,j=f.clientHeight),i=i/2-parseInt(v.alertwidth,10)/2-k.left,j=j/2-25-k.top),d.createModal.call(r,C,"<div class='"+g.call(r,"dialog.body")+"'><div>"+v.alerttext+"</div></div>",{gbox:A,jqModal:v.jqModal,drag:!0,resize:!0,caption:v.alertcap,top:null!=v.alerttop?v.alerttop:j,left:null!=v.alertleft?v.alertleft:i,width:v.alertwidth,height:v.alertheight,closeOnEscape:v.closeOnEscape,zIndex:v.alertzIndex,removemodal:v.removemodal},s.gView,a(A)[0],!1)),d.viewModal.call(r,"#"+e(C.themodal),{gbox:A,toTop:v.alertToTop,jqm:v.jqModal});var l=a("#"+e(C.modalhead)).find(".ui-jqdialog-titlebar-close");l.attr({tabindex:"0",href:"#",role:"button"}),setTimeout(function(){l.focus()},50)}}(),E=function(b){var c;if(13===b.which&&(c=a(this).find(".ui-pg-button").filter(":focus"),c.length>0)){var d=c[0].id,e=d.substr(0,a(this).closest(".ui-jqgrid-toppager").length>0?d.length-u.length-5:d.length-u.length-1),f=e+"mod"+s.id,g=a(".ui-jqdialog").filter(":visible").map(function(){return this.id});if(a.inArray(f,g)<0)return c.trigger("click"),!1}},F=n.call(r,"hover"),G=n.call(r,"disabled"),H=g.call(r,"navButton","ui-pg-button");if(r.grid){r.modalAlert=D,void 0===j&&(s.pager?(j=s.pager,s.toppager&&(v.cloneToTop=!0)):s.toppager&&(j=s.toppager));var I,J,K,L,M,N,O,P=1,Q=["left","center","right"],R=g.call(r,"navButton","ui-pg-button "+n.call(r,"disabled")),S="<div class='"+R+"'><span class='ui-separator'></span></div>",T=function(){i(this,G)||a(this).addClass(F)},U=function(){a(this).removeClass(F)},V=function(){return i(this,G)||(a.isFunction(v.addfunc)?v.addfunc.call(r,m):f.editGridRow.call(t,"new",m)),!1},W=function(b,c,d){if(!i(this,G)){var e=s.selrow;e?a.isFunction(b)?b.call(r,e,d):f[c].call(t,e,d):D()}return!1},X=function(){return W.call(this,v.editfunc,"editGridRow",l)},Y=function(){return W.call(this,v.viewfunc,"viewGridRow",q)},Z=function(){var b;return i(this,G)||(s.multiselect?(b=s.selarrrow,0===b.length&&(b=null)):b=s.selrow,b?a.isFunction(v.delfunc)?v.delfunc.call(r,b,o):f.delGridRow.call(t,b,o):D()),!1},$=function(){return i(this,G)||(a.isFunction(v.searchfunc)?v.searchfunc.call(r,p):f.searchGrid.call(t,p)),!1},_=function(){if(!i(this,G)){a.isFunction(v.beforeRefresh)&&v.beforeRefresh.call(r),s.search=!1,s.resetsearch=!0;try{if("currentfilter"!==v.refreshstate){s.postData.filters="";try{a("#fbox_"+z).jqFilter("resetFilter")}catch(a){}a.isFunction(r.clearToolbar)&&r.clearToolbar(!1)}}catch(a){}switch(v.refreshstate){case"firstpage":t.trigger("reloadGrid",[a.extend({},v.reloadGridOptions||{},{page:1})]);break;case"current":case"currentfilter":t.trigger("reloadGrid",[a.extend({},v.reloadGridOptions||{},{current:!0})])}a.isFunction(v.afterRefresh)&&v.afterRefresh.call(r)}return!1},aa=function(b,c,d){var e=a("<div class='"+H+"' tabindex='0' role='button'></div>"),f=v[b+"icon"],g=a.trim(v[b+"text"]);return e.append("<div class='ui-pg-div'><span class='"+(v.iconsOverText?h("ui-pg-button-icon-over-text",B,f):h(B,f))+"'></span>"+(g?"<span class='ui-pg-button-text"+(v.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+g+"</span>":"")+"</div>"),a(y).append(e),e.attr({title:v[b+"title"]||"",id:c||b+"_"+L}).click(d).hover(T,U),e};for(v.cloneToTop&&s.toppager&&(P=2),I=0;I<P;I++){if(y=a("<div class='ui-pg-table navtable' role='toolbar' style='float:"+("rtl"===s.direction?"right":"left")+";table-layout:auto;'></div>"),0===I?(K=j,L=u,K===s.toppager&&(L+="_top",P=1)):(K=s.toppager,L=u+"_top"),v.add&&aa("add",m.id,V),v.edit&&aa("edit",l.id,X),v.view&&aa("view",q.id,Y),v.del&&aa("del",o.id,Z),(v.add||v.edit||v.del||v.view)&&a(y).append(S),v.search&&(J=aa("search",p.id,$),p.showOnLoad&&p.showOnLoad===!0&&a(J,y).click()),v.refresh&&aa("refresh","",_),x=a(".ui-jqgrid>.ui-jqgrid-view").css("font-size")||"11px",a("body").append("<div id='testpg2' class='"+g.call(r,"gBox","ui-jqgrid")+"' style='font-size:"+x+";visibility:hidden;' ></div>"),w=a(y).clone().appendTo("#testpg2").width(),a("#testpg2").remove(),a(K+"_"+v.position,K).append(y),v.hideEmptyPagerParts)for(M=0;M<Q.length;M++)Q[M]!==v.position&&(O=a(K+"_"+Q[M],K),0===O.length||0===O[0].childNodes.length?O.hide():1===O[0].childNodes.length&&(N=O[0].firstChild,!a(N).is("table.ui-pg-table")||0!==N.rows&&0!==N.rows[0].cells.length||O.hide()));s._nvtd&&(w>s._nvtd[0]&&(a(K+"_"+v.position,K).width(w),s._nvtd[0]=w),s._nvtd[1]=w),r.nav=!0,y.on("keydown.jqGrid",E)}t.triggerHandler("jqGridResetFrozenHeights")}}})},navButtonAdd:function(b,c){return"object"==typeof b&&(c=b,b=void 0),this.each(function(){var j=this,k=j.p;if(j.grid){var l=a.extend({caption:"newButton",title:"",onClickButton:null,position:"last",iconsOverText:!1},f.getGridRes.call(a(j),"nav"),d.nav||{},k.navOptions||{},c||{}),m=l.id,o=n.call(j,"hover"),p=n.call(j,"disabled"),q=g.call(j,"navButton","ui-pg-button");if(void 0===b)if(k.pager){if(f.navButtonAdd.call(a(j),k.pager,l),!k.toppager)return;b=k.toppager,m&&(m+="_top")}else k.toppager&&(b=k.toppager);"string"==typeof b&&0!==b.indexOf("#")&&(b="#"+e(b));var r=a(".navtable",b),s=l.commonIconClass;if(r.length>0){if(m&&r.find("#"+e(m)).length>0)return;var t=a("<div tabindex='0' role='button'></div>");"NONE"===l.buttonicon.toString().toUpperCase()?a(t).addClass(q).append("<div class='ui-pg-div'>"+(l.caption?"<span class='ui-pg-button-text"+(l.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+l.caption+"</span>":"")+"</div>"):a(t).addClass(q).append("<div class='ui-pg-div'><span class='"+(l.iconsOverText?h("ui-pg-button-icon-over-text",s,l.buttonicon):h(s,l.buttonicon))+"'></span>"+(l.caption?"<span class='ui-pg-button-text"+(l.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+l.caption+"</span>":"")+"</div>"),m&&a(t).attr("id",m),"first"===l.position&&r.children("div.ui-pg-button").length>0?r.children("div.ui-pg-button").first().before(t):r.append(t),a(t,r).attr("title",l.title||"").click(function(b){return i(this,p)||a.isFunction(l.onClickButton)&&l.onClickButton.call(j,l,b),!1}).hover(function(){i(this,p)||a(this).addClass(o)},function(){a(this).removeClass(o)}),a(j).triggerHandler("jqGridResetFrozenHeights")}}})},navSeparatorAdd:function(b,c){return c=a.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},c||{}),this.each(function(){if(this.grid){var d=this,h=d.p,i=g.call(d,"navButton","ui-pg-button "+n.call(d,"disabled"));if(void 0===b)if(h.pager){if(f.navSeparatorAdd.call(a(d),h.pager,c),!h.toppager)return;b=h.toppager}else h.toppager&&(b=h.toppager);"string"==typeof b&&0!==b.indexOf("#")&&(b="#"+e(b));var j=a(".navtable",b);if(j.length>0){var k="<div class='"+i+"'><span class='"+c.sepclass+"'></span>"+c.sepcontent+"</div>";"first"===c.position?0===j.children("div.ui-pg-button").length?j.append(k):j.children("div.ui-pg-button").first().before(k):j.append(k)}}})},GridToForm:function(b,c){return this.each(function(){var d,g,h,i,j=this;if(j.grid){var k=f.getRowData.call(a(j),b);if(k)for(d in k)if(k.hasOwnProperty(d))if(g=a("[name="+e(d)+"]",c),g.is("input:radio")||g.is("input:checkbox"))for(h=0;h<g.length;h++)i=a(g[h]),i.prop("checked",i.val()===String(k[d]));else g.val(p(k[d])?"":k[d])}})},FormToGrid:function(b,c,d,e){return this.each(function(){var g=this;if(g.grid){d||(d="set"),e||(e="first");var h=a(c).serializeArray(),i={};a.each(h,function(a,b){i[b.name]=b.value}),"add"===d?f.addRowData.call(a(g),b,i,e):"set"===d&&f.setRowData.call(a(g),b,i)}})}})});
//# sourceMappingURL=grid.formedit.js.map