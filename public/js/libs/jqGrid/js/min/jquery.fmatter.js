!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base"],function(b){return a(b)}):"object"==typeof module&&module.exports?module.exports=function(b,c){return b||(b=window),void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(b)),require("./grid.base"),a(c),c}:a(jQuery)}(function(a){"use strict";a.jgrid=a.jgrid||{};var b=a.jgrid,c=b.getMethod("getGridRes"),d=a.fn.jqGrid;a.fmatter=a.fmatter||{};var e=a.fmatter,f=function(a,b){var c=a.formatoptions||{};return c.hasOwnProperty(b)?c[b]:(a.editoptions||{})[b]},g=function(a){return String(a).replace(/\'/g,"&#39;")},h=function(a){var c,e,h=a.colModel||a.cm,i=h.title!==!1?" title='"+g(a.colName||h.name)+"'":"",j=function(a){return f(h,a)},k=j("checkedClass"),l=j("uncheckedClass"),m=j("value"),n="string"==typeof m?m.split(":")[0]||"Yes":"Yes",o="string"==typeof m?m.split(":")[1]||"No":"No",p=function(a){return"<i class='"+g(a)+"'"+i+"></i>"},q=j("disabled");return void 0===q&&(q=b.formatter.checkbox.disabled),q===!0&&d.isInCommonIconClass.call(this,"fa")?(k=k||"fa fa-check-square-o fa-lg",c=p(k),e=p(l||"fa fa-square-o fa-lg")):q===!0&&d.isInCommonIconClass.call(this,"glyphicon")?(k=k||"glyphicon glyphicon-check",c=p(k),e=p(l||"glyphicon glyphicon-unchecked")):(k="",i+=q===!0?" disabled='disabled'":"",c="<input type='checkbox' checked='checked'"+i+" />",e="<input type='checkbox'"+i+" />"),{checkedClasses:k,checked:c,unchecked:e,yes:n,no:o}},i={1:1,x:1,true:1,yes:1,y:1,on:1},j={0:1,false:1,no:1,n:1,off:1};a.extend(!0,b,{formatter:{date:{parseRe:/[#%\\\/:_;.,\t\s\-]/,masks:{ISO8601Long:"Y-m-d H:i:s",ISO8601Short:"Y-m-d",SortableDateTime:"Y-m-d\\TH:i:s",UniversalSortableDateTime:"Y-m-d H:i:sO"},reformatAfterEdit:!0,userLocalTime:!1},baseLinkUrl:"",showAction:"",target:"",checkbox:{disabled:!0,defaultValue:!1},idName:"id"},cmTemplate:{integerStr:{formatter:"integer",align:"right",sorttype:"integer",searchoptions:{sopt:["eq","ne","lt","le","gt","ge"]}},integer:{formatter:"integer",align:"right",sorttype:"integer",convertOnSave:function(a){var b=a.newValue;return isNaN(b)?b:parseInt(b,10)},searchoptions:{sopt:["eq","ne","lt","le","gt","ge"]}},numberStr:{formatter:"number",align:"right",sorttype:"number",searchoptions:{sopt:["eq","ne","lt","le","gt","ge"]}},number:{formatter:"number",align:"right",sorttype:"number",convertOnSave:function(a){var b=a.newValue;return isNaN(b)?b:parseFloat(b)},searchoptions:{sopt:["eq","ne","lt","le","gt","ge"]}},booleanCheckbox:{align:"center",formatter:"checkbox",sorttype:"boolean",edittype:"checkbox",editoptions:{value:"true:false",defaultValue:"false"},convertOnSave:function(a){var b=a.newValue,c=h.call(this,a),d=String(b).toLowerCase();return i[d]||d===c.yes.toLowerCase()?b=!0:(j[d]||d===c.no.toLowerCase())&&(b=!1),b},stype:"checkbox",searchoptions:{sopt:["eq"],value:"true:false"}},actions:function(){return{formatter:"actions",width:(null!=this.p&&(d.isInCommonIconClass.call(this,"fa")||d.isInCommonIconClass.call(this,"glyphicon"))?a(this).jqGrid("isBootstrapGuiStyle")?45:39:40)+(b.cellWidth()?5:0),align:"center",label:"",autoResizable:!1,frozen:!0,fixed:!0,hidedlg:!0,resizable:!1,sortable:!1,search:!1,editable:!1,viewable:!1}}}}),b.cmTemplate.booleanCheckboxFa=b.cmTemplate.booleanCheckbox,a.extend(e,{isObject:function(b){return b&&("object"==typeof b||a.isFunction(b))||!1},isNumber:function(a){return"number"==typeof a&&isFinite(a)},isValue:function(a){return this.isObject(a)||"string"==typeof a||this.isNumber(a)||"boolean"==typeof a},isEmpty:function(b){return("string"==typeof b||!this.isValue(b))&&(!this.isValue(b)||""===(b=a.trim(b).replace(/&nbsp;/gi,"").replace(/&#160;/gi,"")))},NumberFormat:function(a,b){var c=e.isNumber;if(c(a)||(a*=1),c(a)){var d,f=a<0,g=String(a),h=b.decimalSeparator||".";if(c(b.decimalPlaces)){var i=b.decimalPlaces,j=Math.pow(10,i);if(g=String(Math.round(a*j)/j),d=g.lastIndexOf("."),i>0)for(d<0?(g+=h,d=g.length-1):"."!==h&&(g=g.replace(".",h));g.length-1-d<i;)g+="0"}if(b.thousandsSeparator){var k=b.thousandsSeparator;d=g.lastIndexOf(h),d=d>-1?d:g.length;var l,m=void 0===b.decimalSeparator?"":g.substring(d),n=-1;for(l=d;l>0;l--)n++,n%3==0&&l!==d&&(!f||l>1)&&(m=k+m),m=g.charAt(l-1)+m;g=m}return g}return a}});var k=function(b,d,e,f,g){var h=d;e=a.extend({},c.call(a(this),"formatter"),e);try{h=a.fn.fmatter[b].call(this,d,e,f,g)}catch(a){}return h};a.fn.fmatter=k,k.getCellBuilder=function(b,d,e){var f=null!=a.fn.fmatter[b]?a.fn.fmatter[b].getCellBuilder:null;return a.isFunction(f)?f.call(this,a.extend({},c.call(a(this),"formatter"),d),e):null},k.defaultFormat=function(a,b){return e.isValue(a)&&""!==a?a:b.defaultValue||"&#160;"};var l=k.defaultFormat,m=function(a,b,c){if(void 0===a||e.isEmpty(a)){var d=f(c,"defaultValue");void 0===d&&(d=b.no),a=d}return a=String(a).toLowerCase(),i[a]||a===b.yes.toLowerCase()?b.checked:b.unchecked};k.email=function(a,b){return e.isEmpty(a)?l(a,b):"<a href='mailto:"+g(a)+"'>"+a+"</a>"},k.checkbox=function(a,b){return m(a,h.call(this,b),b.colModel)},k.checkbox.getCellBuilder=function(a){var b,c=a.colModel;return a.colName=a.colName||this.p.colNames[a.pos],b=h.call(this,a),function(a){return m(a,b,c)}},k.checkbox.unformat=function(c,d,e){var f=h.call(this,d),g=a(e);return(f.checkedClasses?b.hasAllClasses(g.children("i"),f.checkedClasses):g.children("input").is(":checked"))?f.yes:f.no},k.checkboxFontAwesome4=k.checkbox,k.checkboxFontAwesome4.getCellBuilder=k.checkbox.getCellBuilder,k.checkboxFontAwesome4.unformat=k.checkbox.unformat,k.link=function(b,c){var d=c.colModel,f="",h={target:c.target};return null!=d&&(h=a.extend({},h,d.formatoptions||{})),h.target&&(f="target="+h.target),e.isEmpty(b)?l(b,h):"<a "+f+" href='"+g(b)+"'>"+b+"</a>"},k.showlink=function(b,c,d){var f,h,i,j=this,k=c.colModel,m={baseLinkUrl:c.baseLinkUrl,showAction:c.showAction,addParam:c.addParam||"",target:c.target,idName:c.idName,hrefDefaultValue:"#"},n="",o=function(e){return a.isFunction(e)?e.call(j,{cellValue:b,rowid:c.rowId,rowData:d,options:m}):e||""};return null!=k&&(m=a.extend({},m,k.formatoptions||{})),m.target&&(n="target="+o(m.target)),f=o(m.baseLinkUrl)+o(m.showAction),h=m.idName?encodeURIComponent(o(m.idName))+"="+encodeURIComponent(o(m.rowId)||c.rowId):"",i=o(m.addParam),"object"==typeof i&&null!==i&&(i=(""!==h?"&":"")+a.param(i)),f+=h||i?"?"+h+i:"",""===f&&(f=o(m.hrefDefaultValue)),"string"==typeof b||e.isNumber(b)||a.isFunction(m.cellValue)?"<a "+n+" href='"+g(f)+"'>"+(a.isFunction(m.cellValue)?o(m.cellValue):b)+"</a>":l(b,m)},k.showlink.getCellBuilder=function(b){var c={baseLinkUrl:b.baseLinkUrl,showAction:b.showAction,addParam:b.addParam||"",target:b.target,idName:b.idName,hrefDefaultValue:"#"},d=b.colModel;return null!=d&&(c=a.extend({},c,d.formatoptions||{})),function(b,d,f){var h,i,j,k=this,m=d.rowId,n="",o=function(d){return a.isFunction(d)?d.call(k,{cellValue:b,rowid:m,rowData:f,options:c}):d||""};return c.target&&(n="target="+o(c.target)),h=o(c.baseLinkUrl)+o(c.showAction),i=c.idName?encodeURIComponent(o(c.idName))+"="+encodeURIComponent(o(m)||d.rowId):"",j=o(c.addParam),"object"==typeof j&&null!==j&&(j=(""!==i?"&":"")+a.param(j)),h+=i||j?"?"+i+j:"",""===h&&(h=o(c.hrefDefaultValue)),"string"==typeof b||e.isNumber(b)||a.isFunction(c.cellValue)?"<a "+n+" href='"+g(h)+"'>"+(a.isFunction(c.cellValue)?o(c.cellValue):b)+"</a>":l(b,c)}},k.showlink.pageFinalization=function(b){var c,d,e,f=a(this),g=this.p,h=g.colModel,i=h[b],j=this.rows,k=j.length,l=function(c){var d=a(this).closest(".jqgrow");if(d.length>0)return i.formatoptions.onClick.call(f[0],{iCol:b,iRow:d[0].rowIndex,rowid:d.attr("id"),cm:i,cmName:i.name,cellValue:a(this).text(),a:this,event:c})};if(null!=i.formatoptions&&a.isFunction(i.formatoptions.onClick))for(c=0;c<k;c++)d=j[c],a(d).hasClass("jqgrow")&&(e=d.cells[b],i.autoResizable&&null!=e&&a(e.firstChild).hasClass(g.autoResizing.wrapperClassName)&&(e=e.firstChild),null!=e&&a(e.firstChild).on("click",l))};var n=function(a,b){return a=b.prefix?b.prefix+a:a,b.suffix?a+b.suffix:a},o=function(b,c,d){var f=c.colModel,g=a.extend({},c[d]);return null!=f&&(g=a.extend({},g,f.formatoptions||{})),e.isEmpty(b)?n(g.defaultValue,g):n(e.NumberFormat(b,g),g)};k.integer=function(a,b){return o(a,b,"integer")},k.number=function(a,b){return o(a,b,"number")},k.currency=function(a,b){return o(a,b,"currency")};var p=function(b,c){var d=b.colModel,f=a.extend({},b[c]);null!=d&&(f=a.extend({},f,d.formatoptions||{}));var g=e.NumberFormat,h=f.defaultValue?n(f.defaultValue,f):"";return function(a){return e.isEmpty(a)?h:n(g(a,f),f)}};k.integer.getCellBuilder=function(a){return p(a,"integer")},k.number.getCellBuilder=function(a){return p(a,"number")},k.currency.getCellBuilder=function(a){return p(a,"currency")},k.date=function(c,d,f,g){var h=d.colModel,i=a.extend({},d.date);return null!=h&&(i=a.extend({},i,h.formatoptions||{})),i.reformatAfterEdit||"edit"!==g?e.isEmpty(c)?l(c,i):b.parseDate.call(this,i.srcformat,c,i.newformat,i):l(c,i)},k.date.getCellBuilder=function(c,d){var f=a.extend({},c.date);null!=c.colModel&&(f=a.extend({},f,c.colModel.formatoptions||{}));var g=b.parseDate,h=f.srcformat,i=f.newformat;return f.reformatAfterEdit||"edit"!==d?function(a){return e.isEmpty(a)?l(a,f):g.call(this,h,a,i,f)}:function(a){return l(a,f)}},k.select=function(b,c){var d,f=[],g=c.colModel,h=a.extend({},g.editoptions||{},g.formatoptions||{}),i=h.value,j=h.separator||":",k=h.delimiter||";";if(i){var m,n=h.multiple===!0,o=[],p=function(a,b){if(b>0)return a};if(n&&(o=a.map(String(b).split(","),function(b){return a.trim(b)})),"string"==typeof i){var q,r,s=i.split(k);for(q=0;q<s.length;q++)if(m=s[q].split(j),m.length>2&&(m[1]=a.map(m,p).join(j)),r=a.trim(m[0]),h.defaultValue===r&&(d=m[1]),n)a.inArray(r,o)>-1&&f.push(m[1]);else if(r===a.trim(b)){f=[m[1]];break}}else e.isObject(i)&&(d=i[h.defaultValue],f=n?a.map(o,function(a){return i[a]}):[void 0===i[b]?"":i[b]])}return b=f.join(", "),""!==b?b:void 0!==h.defaultValue?d:l(b,h)},k.select.getCellBuilder=function(b){var c,d,f,g,h,i=b.colModel,j=k.defaultFormat,l=a.extend({},i.editoptions||{},i.formatoptions||{}),m=l.value,n=l.separator||":",o=l.delimiter||";",p=void 0!==l.defaultValue,q=l.multiple===!0,r={},s=function(a,b){if(b>0)return a};if("string"==typeof m)for(f=m.split(o),h=f.length,g=h-1;g>=0;g--)d=f[g].split(n),d.length>2&&(d[1]=a.map(d,s).join(n)),r[a.trim(d[0])]=d[1];else{if(!e.isObject(m))return function(a){return a?String(a):j(a,l)};r=m}return p&&(c=r[l.defaultValue]),q?function(b){var d,e=[],f=a.map(String(b).split(","),function(b){return a.trim(b)});for(d=0;d<f.length;d++)b=f[d],r.hasOwnProperty(b)&&e.push(r[b]);return b=e.join(", "),""!==b?b:p?c:j(b,l)}:function(a){var b=r[String(a)];return""!==b&&void 0!==b?b:p?c:j(a,l)}},k.rowactions=function(c,d){var e,f,g,h,i=a(this).closest("tr.jqgrow"),j=i.attr("id"),k=a(this).closest("table.ui-jqgrid-btable").attr("id").replace(/_frozen([^_]*)$/,"$1"),l=a("#"+b.jqID(k)),m=l[0],n=m.p,o=b.getRelativeRect.call(m,i).top,p=n.colModel[b.getCellIndex(this)],q=a.extend(!0,{extraparam:{}},b.actionsNav||{},n.actionsNavOptions||{},p.formatoptions||{});switch(void 0!==n.editOptions&&(q.editOptions=a.extend(!0,q.editOptions||{},n.editOptions)),void 0!==n.delOptions&&(q.delOptions=n.delOptions),i.hasClass("jqgrid-new-row")&&(q.extraparam[n.prmNames.oper]=n.prmNames.addoper),h={keys:q.keys,oneditfunc:q.onEdit,successfunc:q.onSuccess,url:q.url,extraparam:q.extraparam,aftersavefunc:q.afterSave,errorfunc:q.onError,afterrestorefunc:q.afterRestore,restoreAfterError:q.restoreAfterError,mtype:q.mtype},!n.multiselect&&j!==n.selrow||n.multiselect&&a.inArray(j,n.selarrrow)<0?l.jqGrid("setSelection",j,!0,c):b.fullBoolFeedback.call(m,"onSelectRow","jqGridSelectRow",j,!0,c),d){case"edit":l.jqGrid("editRow",j,h);break;case"save":l.jqGrid("saveRow",j,h);break;case"cancel":l.jqGrid("restoreRow",j,q.afterRestore);break;case"del":q.delOptions=q.delOptions||{},void 0===q.delOptions.top&&(q.delOptions.top=o),l.jqGrid("delGridRow",j,q.delOptions);break;case"formedit":q.editOptions=q.editOptions||{},void 0===q.editOptions.top&&(q.editOptions.top=o,q.editOptions.recreateForm=!0),l.jqGrid("editGridRow",j,q.editOptions);break;default:if(null!=q.custom&&q.custom.length>0)for(f=q.custom.length,e=0;e<f;e++)g=q.custom[e],g.action===d&&a.isFunction(g.onClick)&&g.onClick.call(m,{rowid:j,event:c,action:d,options:g})}return c.stopPropagation&&c.stopPropagation(),!1},k.actions=function(d,f,h,i){var j,k,l,m=f.rowId,n="",o=this,p=o.p,q=a(o),r={},s=c.call(q,"edit")||{},t=a.extend({editbutton:!0,delbutton:!0,editformbutton:!1,commonIconClass:"ui-icon",editicon:"ui-icon-pencil",delicon:"ui-icon-trash",saveicon:"ui-icon-disk",cancelicon:"ui-icon-cancel",savetitle:s.bSubmit||"",canceltitle:s.bCancel||""},c.call(q,"nav")||{},b.nav||{},p.navOptions||{},c.call(q,"actionsNav")||{},b.actionsNav||{},p.actionsNavOptions||{},f.colModel.formatoptions||{}),u=function(a){return b.mergeCssClasses(t.commonIconClass,t[a+"icon"])},v=q.jqGrid("getGuiStyles","states.hover"),w="onmouseover=\"jQuery(this).addClass('"+v+"');\" onmouseout=\"jQuery(this).removeClass('"+v+"');\"",x=[{action:"edit",actionName:"formedit",display:t.editformbutton},{action:"edit",display:!t.editformbutton&&t.editbutton},{action:"del",idPrefix:"Delete",display:t.delbutton},{action:"save",display:t.editformbutton||t.editbutton,hidden:!0},{action:"cancel",display:t.editformbutton||t.editbutton,hidden:!0}],y=null!=t.custom?t.custom.length-1:-1;if(void 0===m||e.isEmpty(m))return"";if(a.isFunction(t.isDisplayButtons))try{r=t.isDisplayButtons.call(o,f,h,i)||{}}catch(a){}for(;y>=0;)k=t.custom[y--],x["first"===k.position?"unshift":"push"](k);for(j=0,y=x.length;j<y;j++)l=a.extend({},x[j],r[x[j].action]||{}),l.display!==!1&&(n+=function(a){var b=a.action,c=a.actionName||b,d=void 0!==a.idPrefix?a.idPrefix:b.charAt(0).toUpperCase()+b.substring(1);return"<div title='"+g(t[b+"title"])+(a.hidden?"' style='display:none;":"")+"' class='"+g(q.jqGrid("getGuiStyles","actionsButton","ui-pg-div ui-inline-"+b))+"' "+(null!==d?"id='j"+g(d+"Button_"+m):"")+"' onclick=\"return jQuery.fn.fmatter.rowactions.call(this,event,'"+c+"');\" "+(a.noHovering?"":w)+"><span class='"+g(u(b))+"'></span></div>"}(l));return"<div class='"+g(q.jqGrid("getGuiStyles","actionsDiv","ui-jqgrid-actions"))+"'>"+n+"</div>"},k.actions.pageFinalization=function(b){var c=a(this),d=this.p,e=d.colModel,f=e[b],g=function(g,h){var i,j,k,l=0,m=e.length;for(k=0;k<m&&e[k].frozen===!0;k++)l=k;null!=(i=c.jqGrid("getGridRowById",h))&&null!=i.cells&&(b=d.iColByName[f.name],j=a(i.cells[b]).children(".ui-jqgrid-actions"),f.frozen&&d.frozenColumns&&b<=l&&(j=j.add(a(c[0].grid.fbRows[i.rowIndex].cells[b]).children(".ui-jqgrid-actions"))),g?(j.find(">.ui-inline-edit,>.ui-inline-del").show(),j.find(">.ui-inline-save,>.ui-inline-cancel").hide()):(j.find(">.ui-inline-edit,>.ui-inline-del").hide(),j.find(">.ui-inline-save,>.ui-inline-cancel").show()))},h=function(a,b){return g(!0,b),!1},i=function(a,b){return g(!1,b),!1};null!=f.formatoptions&&f.formatoptions.editformbutton||(c.off("jqGridInlineAfterRestoreRow.jqGridFormatter jqGridInlineAfterSaveRow.jqGridFormatter",h),c.on("jqGridInlineAfterRestoreRow.jqGridFormatter jqGridInlineAfterSaveRow.jqGridFormatter",h),c.off("jqGridInlineEditRow.jqGridFormatter",i),c.on("jqGridInlineEditRow.jqGridFormatter",i))},a.unformat=function(d,e,f,g){var h,i=e.colModel,j=i.formatter,l=this.p,m=i.formatoptions||{},n=i.unformat||k[j]&&k[j].unformat;if(d instanceof jQuery&&d.length>0&&(d=d[0]),l.treeGrid&&null!=d&&a(d.firstChild).hasClass("tree-wrap")&&(a(d.lastChild).hasClass("cell-wrapper")||a(d.lastChild).hasClass("cell-wrapperleaf"))&&(d=d.lastChild),i.autoResizable&&null!=d&&a(d.firstChild).hasClass(l.autoResizing.wrapperClassName)&&(d=d.firstChild),void 0!==n&&a.isFunction(n))h=n.call(this,a(d).text(),e,d);else if(void 0!==j&&"string"==typeof j){var o=a(this),p=function(a,b){return void 0!==m[b]?m[b]:c.call(o,"formatter."+a+"."+b)},q=function(a,b){var c=p(a,"thousandsSeparator").replace(/([\.\*\_\'\(\)\{\}\+\?\\])/g,"\\$1");return b.replace(new RegExp(c,"g"),"")};switch(j){case"integer":h=q("integer",a(d).text());break;case"number":h=q("number",a(d).text()).replace(p("number","decimalSeparator"),".");break;case"currency":h=a(d).text();var r=p("currency","prefix"),s=p("currency","suffix");r&&r.length&&(h=h.substr(r.length)),s&&s.length&&(h=h.substr(0,h.length-s.length)),h=q("number",h).replace(p("number","decimalSeparator"),".");break;case"checkbox":h=k.checkbox.unformat(d,e,d);break;case"select":h=a.unformat.select(d,e,f,g);break;case"actions":return"";default:h=a(d).text()}}return h=void 0!==h?h:g===!0?a(d).text():b.htmlDecode(a(d).html())},a.unformat.select=function(b,c,d,f){var g=[],h=a(b).text(),i=c.colModel;if(f===!0)return h;var j=a.extend({},i.editoptions||{},i.formatoptions||{}),k=void 0===j.separator?":":j.separator,l=void 0===j.delimiter?";":j.delimiter;if(j.value){var m,n=j.value,o=j.multiple===!0,p=[],q=function(a,b){if(b>0)return a};if(o&&(p=h.split(","),p=a.map(p,function(b){return a.trim(b)})),"string"==typeof n){var r,s=n.split(l),t=0;for(r=0;r<s.length;r++)if(m=s[r].split(k),m.length>2&&(m[1]=a.map(m,q).join(k)),o)a.inArray(a.trim(m[1]),p)>-1&&(g[t]=m[0],t++);else if(a.trim(m[1])===a.trim(h)){g[0]=m[0];break}}else(e.isObject(n)||a.isArray(n))&&(o||(p[0]=h),g=a.map(p,function(b){var c;if(a.each(n,function(a,d){if(d===b)return c=a,!1}),void 0!==c)return c}));return g.join(", ")}return h||""},a.unformat.date=function(d,f){var g=a.extend(!0,{},c.call(a(this),"formatter.date"),b.formatter.date||{},f.formatoptions||{});return e.isEmpty(d)?"":b.parseDate.call(this,g.newformat,d,g.srcformat,g)}});
//# sourceMappingURL=jquery.fmatter.js.map