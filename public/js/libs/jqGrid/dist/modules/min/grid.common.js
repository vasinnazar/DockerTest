!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jqdnr","./jqmodal"],function(c){return b(c,a.document)}):"object"==typeof module&&module.exports?module.exports=function(a,c){return a||(a=window),void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(a)),require("./grid.base"),require("./jqdnr"),require("./jqmodal"),b(c,a.document),c}:b(jQuery,a.document)}("undefined"!=typeof window?window:this,function(a,b){"use strict";var c=a.jgrid,d=a.fn.jqGrid,e=d.getGuiStyles,f=d.getGridRes;c.jqModal=c.jqModal||{},a.extend(!0,c.jqModal,{toTop:!0}),a.extend(c,{showModal:function(a){a.w.show()},closeModal:function(a){a.w.hide().attr("aria-hidden","true"),a.o&&a.o.remove()},hideModal:function(b,c){c=a.extend({jqm:!0,gb:"",removemodal:!1},c||{});var d=!(!c.gb||"string"!=typeof c.gb||"#gbox_"!==c.gb.substr(0,6))&&a("#"+c.gb.substr(6))[0],e=a(b);if(c.onClose){var f=d?c.onClose.call(d,b):c.onClose(b);if("boolean"==typeof f&&!f)return}if(a.fn.jqm&&c.jqm===!0)e.attr("aria-hidden","true").jqmHide();else{if(""!==c.gb)try{a(">.jqgrid-overlay",c.gb).first().hide()}catch(a){}e.hide().attr("aria-hidden","true")}c.removemodal&&e.remove()},createModal:function(f,g,h,i,j,k,l){var m=c.jqID,n=this.p;h=a.extend(!0,{resizingRightBottomIcon:d.getIconRes.call(this,"form.resizableLtr")},c.jqModal||{},null!=n?n.jqModal||{}:{},h);var o=b.createElement("div"),p="#"+m(f.themodal),q="rtl"===a(h.gbox).attr("dir"),r=!!f.resizeAlso&&"#"+m(f.resizeAlso);l=a.extend({},l||{}),o.className=e.call(this,"dialog.window","ui-jqdialog"),o.id=f.themodal,o.dir=q?"rtl":"ltr";var s=b.createElement("div");s.className=e.call(this,"dialog.document"),a(s).attr("role","document");var t=b.createElement("div");t.className=e.call(this,"dialog.subdocument"),s.appendChild(t),o.appendChild(s);var u=b.createElement("div");u.className=e.call(this,"dialog.header","ui-jqdialog-titlebar "+(q?"ui-jqdialog-titlebar-rtl":"ui-jqdialog-titlebar-ltr")),u.id=f.modalhead,a(u).append("<span class='ui-jqdialog-title'>"+h.caption+"</span>");var v=e.call(this,"states.hover"),w=a("<a aria-label='Close' class='"+e.call(this,"dialog.closeButton","ui-jqdialog-titlebar-close")+"'></a>").hover(function(){w.addClass(v)},function(){w.removeClass(v)}).append("<span class='"+d.getIconRes.call(this,"form.close")+"'></span>");a(u).append(w);var x=b.createElement("div");a(x).addClass(e.call(this,"dialog.content","ui-jqdialog-content")).attr("id",f.modalcontent),a(x).append(g),t.appendChild(x),a(t).prepend(u),k===!0?a("body").append(o):"string"==typeof k?a(k).append(o):a(o).insertBefore(i),a(o).css(l),void 0===h.jqModal&&(h.jqModal=!0);var y={};if(a.fn.jqm&&h.jqModal===!0?(0===h.left&&0===h.top&&h.overlay&&(h=a(j).offset(),h.left+=4,h.top+=4),y.top=h.top+"px",y.left=h.left):0===h.left&&0===h.top||(y.left=h.left,y.top=h.top+"px"),a("a.ui-jqdialog-titlebar-close",u).click(function(){var b=a(p).data("onClose")||h.onClose,d=a(p).data("gbox")||h.gbox;return c.hideModal(p,{gb:d,jqm:h.jqModal,onClose:b,removemodal:h.removemodal||!1}),!1}),0!==h.width&&h.width||(h.width=300),0!==h.height&&h.height||(h.height=200),!h.zIndex){var z=a(i).parents("*[role=dialog]").first().css("z-index");z?(h.zIndex=parseInt(z,10)+2,h.toTop=!0):h.zIndex=950}if(y.left&&(y.left+="px"),a(o).css(a.extend({width:isNaN(h.width)?"auto":h.width+"px",height:isNaN(h.height)?"auto":h.height+"px",zIndex:h.zIndex},y)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":f.modalhead,"aria-hidden":"true"}),void 0===h.drag&&(h.drag=!0),void 0===h.resize&&(h.resize=!0),h.drag)if(a.fn.jqDrag)a(u).css("cursor","move"),a(o).jqDrag(u);else try{a(o).draggable({handle:a("#"+m(u.id))})}catch(a){}if(h.resize)if(a.fn.jqResize)a(x).append("<div class='jqResize ui-resizable-handle ui-resizable-se "+h.resizingRightBottomIcon+"'></div>"),a(p).jqResize(".jqResize",r);else try{a(o).resizable({handles:"se, sw",alsoResize:r})}catch(a){}h.closeOnEscape===!0&&a(o).keydown(function(b){if(27===b.which){var d=a(p).data("onClose")||h.onClose;c.hideModal(p,{gb:h.gbox,jqm:h.jqModal,onClose:d,removemodal:h.removemodal||!1,formprop:!h.recreateForm||!1,form:h.form||""})}})},viewModal:function(b,d){if(d=a.extend(!0,{overlay:30,modal:!1,overlayClass:e.call(this,"overlay"),onShow:c.showModal,onHide:c.closeModal,gbox:"",jqm:!0,jqM:!0},c.jqModal||{},d||{}),a.fn.jqm&&d.jqm===!0)d.jqM?a(b).attr("aria-hidden","false").jqm(d).jqmShow():a(b).attr("aria-hidden","false").jqmShow();else{""!==d.gbox&&(a(">.jqgrid-overlay",d.gbox).first().show(),a(b).data("gbox",d.gbox)),a(b).show().attr("aria-hidden","false");try{a(":input:visible",b)[0].focus()}catch(a){}}},info_dialog:function(b,d,f,g){var h=this,i=h.p,j=a.extend(!0,{width:290,height:"auto",dataheight:"auto",drag:!0,resize:!1,left:250,top:170,zIndex:1e3,jqModal:!0,modal:!1,closeOnEscape:!0,align:"center",buttonalign:"center",buttons:[]},c.jqModal||{},null!=i?i.jqModal||{}:{},{caption:"<b>"+b+"</b>"},g||{}),k=j.jqModal;a.fn.jqm&&!k&&(k=!1);var l,m="",n=e.call(h,"states.hover");if(j.buttons.length>0)for(l=0;l<j.buttons.length;l++)void 0===j.buttons[l].id&&(j.buttons[l].id="info_button_"+l),m+=c.builderFmButon.call(h,j.buttons[l].id,j.buttons[l].text);var o=isNaN(j.dataheight)?j.dataheight:j.dataheight+"px",p="text-align:"+j.align+";",q=a("#info_dialog"),r="<div id='info_id'>";r+="<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+o+";"+p+"'>"+d+"</div>",(f||""!==m)&&(r+="<hr class='"+e.call(h,"dialog.hr")+"' style='margin:1px'/><div style='text-align:"+j.buttonalign+";padding:.8em 0 .5em 0;background-image:none;border-width: 1px 0 0 0;'>"+(f?c.builderFmButon.call(h,"closedialog",f):"")+m+"</div>"),r+="</div>";try{"false"===q.attr("aria-hidden")&&c.hideModal("#info_dialog",{jqm:k}),q.remove()}catch(a){}c.createModal.call(h,{themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",resizeAlso:"infocnt"},r,j,"","",!0),q=a("#info_dialog"),m&&a.each(j.buttons,function(){a("#"+c.jqID(this.id),"#info_id").on("click",{click:this.onClick},function(b){return a.isFunction(b.data.click)&&b.data.click.call(h,b,q),!1})}),a("#closedialog","#info_id").click(function(){return c.hideModal("#info_dialog",{jqm:k,onClose:q.data("onClose")||j.onClose,gb:q.data("gbox")||j.gbox}),!1}),a(".fm-button","#info_dialog").hover(function(){a(this).addClass(n)},function(){a(this).removeClass(n)}),a.isFunction(j.beforeOpen)&&j.beforeOpen(),c.viewModal.call(h,"#info_dialog",{onHide:function(a){a.w.hide().remove(),a.o&&a.o.remove()},modal:j.modal,jqm:k}),a.isFunction(j.afterOpen)&&j.afterOpen();try{q.focus()}catch(a){}},bindEv:function(b,c){var d=this;a.isFunction(c.dataInit)&&c.dataInit.call(d,b,c),c.dataEvents&&a.each(c.dataEvents,function(){void 0!==this.data?a(b).on(this.type,this.data,this.fn):a(b).on(this.type,this.fn)})},createEl:function(d,e,g,h,i){function j(b,d,e){var f=["dataInit","dataEvents","dataUrl","buildSelect","sopt","searchhidden","defaultValue","attr","custom_element","custom_value","selectFilled","rowId","column","mode","cm","iCol"];void 0!==e&&a.isArray(e)&&a.merge(f,e),a.each(d,function(c,d){a.inArray(c,f)===-1&&a(b).attr(c,d)}),d.hasOwnProperty("id")||a(b).attr("id",c.randId())}var k="",l=this,m=l.p,n=c.info_dialog,o=function(b){return f.call(a(l),b)},p=o("errors.errcap"),q=o("edit"),r=q.msg,s=q.bClose;if(null==e)return"";switch(d){case"textarea":k=b.createElement("textarea"),h?e.cols||a(k).css({width:"100%","box-sizing":"border-box"}):e.cols||(e.cols=19),e.rows||(e.rows=2),("&nbsp;"===g||"&#160;"===g||1===g.length&&160===g.charCodeAt(0))&&(g=""),k.value=g,j(k,e),a(k).attr({role:"textbox"});break;case"checkbox":if(k=b.createElement("input"),k.type="checkbox",e.value){var t=e.value.split(":");g===t[0]&&(k.checked=!0,k.defaultChecked=!0),k.value=t[0],a(k).data("offval",t[1])}else{var u=String(g).toLowerCase();u.search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==u?(k.checked=!0,k.defaultChecked=!0,k.value=g):k.value="on",a(k).data("offval","off")}j(k,e,["value"]),a(k).attr({role:"checkbox","aria-checked":k.checked?"true":"false"});break;case"select":k=b.createElement("select");var v,w=[],x=null;e.multiple===!0?(v=!0,k.multiple="multiple",a(k).attr("aria-multiselectable","true"),w=g.split(","),w=a.map(w,function(b){return a.trim(b)})):(v=!1,w[0]=a.trim(g)),void 0===e.size&&(e.size=v?3:1);try{x=e.rowId}catch(a){}if(m&&m.idPrefix&&(x=c.stripPref(m.idPrefix,x)),void 0===e.dataUrl&&e.generateValue&&null!=m.indexByColumnData[e.cm.name]&&(e.value=l.generateValueFromColumnIndex(e.cm.name,e.separator,e.delimiter)),void 0!==e.dataUrl){var y=e.postData||i.postData,z={elem:k,options:e,cm:e.cm,mode:e.mode,rowid:x,iCol:e.iCol,ovm:w};j(k,e,y?["postData"]:void 0),a.ajax(a.extend({url:a.isFunction(e.dataUrl)?e.dataUrl.call(l,x,g,String(e.name),z):e.dataUrl,type:"GET",dataType:"html",data:a.isFunction(y)?y.call(l,x,g,String(e.name)):y,context:z,success:function(b,d,e){var f=this.ovm,g=this.elem,h=this.cm,i=this.iCol,j=a.extend({},this.options),k=this.rowid,m=this.mode,n=a.isFunction(j.buildSelect)?j.buildSelect.call(l,b,e,h,i):b;"string"==typeof n&&(n=a(a.trim(n)).html()),n&&(a(g).append(n),setTimeout(function(){var b;a("option",g).each(function(c){0===c&&g.multiple&&(this.selected=!1),a.inArray(a.trim(a(this).val()),f)>-1&&(this.selected=!0,b=!0)}),b||a("option",g).each(function(){a.inArray(a.trim(a(this).text()),f)>-1&&(this.selected=!0)}),c.fullBoolFeedback.call(l,j.selectFilled,"jqGridSelectFilled",{elem:g,options:j,cm:h,rowid:k,mode:m,cmName:null!=h?h.name:j.name,iCol:i})},0))}},i||{}))}else e.value&&(c.fillSelectOptions(k,e.value,void 0===e.separator?":":e.separator,void 0===e.delimiter?";":e.delimiter,v,g),j(k,e,["value"]),c.fullBoolFeedback.call(l,e.selectFilled,"jqGridSelectFilled",{elem:k,options:e,cm:e.cm,rowid:x,mode:e.mode,cmName:null!=e.cm?e.cm.name:e.name,iCol:e.iCol}));break;case"text":case"password":case"button":var A;A="button"===d?"button":"textbox",k=b.createElement("input"),k.type=d,j(k,e),k.value=g,"button"!==d&&(h?e.size||a(k).css({width:"100%","box-sizing":"border-box"}):e.size||(e.size=20)),a(k).attr("role",A);break;case"image":case"file":k=b.createElement("input"),k.type=d,j(k,e);break;case"custom":k=b.createElement("span");try{if(!a.isFunction(e.custom_element))throw"editoptions.custom_element is not a function";var B=e.custom_element.call(l,g,e);if(!(B instanceof jQuery||c.isHTMLElement(B)||"string"==typeof B))throw"editoptions.custom_element returns value of a wrong type";B=a(B).addClass("customelement").attr({id:e.id,name:e.name}),a(k).empty().append(B)}catch(a){"e1"===a&&n.call(l,p,"function 'custom_element' "+r.nodefined,s),"e2"===a?n.call(l,p,"function 'custom_element' "+r.novalue,s):n.call(l,p,"string"==typeof a?a:a.message,s)}}return k},checkDate:function(a,b){var c,d={};if(a=a.toLowerCase(),c=a.indexOf("/")!==-1?"/":a.indexOf("-")!==-1?"-":a.indexOf(".")!==-1?".":"/",a=a.split(c),b=b.split(c),3!==b.length)return!1;var e,f,g,h=-1,i=-1,j=-1;for(f=0;f<a.length;f++)g=isNaN(b[f])?0:parseInt(b[f],10),d[a[f]]=g,e=a[f],e.indexOf("y")!==-1&&(h=f),e.indexOf("m")!==-1&&(j=f),e.indexOf("d")!==-1&&(i=f);e="y"===a[h]||"yyyy"===a[h]?4:"yy"===a[h]?2:-1;var k,l=[0,31,29,31,30,31,30,31,31,30,31,30,31];return h!==-1&&(k=d[a[h]].toString(),2===e&&1===k.length&&(e=1),k.length===e&&(0!==d[a[h]]||"00"===b[h])&&(j!==-1&&(k=d[a[j]].toString(),!(k.length<1||d[a[j]]<1||d[a[j]]>12)&&(i!==-1&&(k=d[a[i]].toString(),!(k.length<1||d[a[i]]<1||d[a[i]]>31||2===d[a[j]]&&d[a[i]]>function(a){return a%4!=0||a%100==0&&a%400!=0?28:29}(d[a[h]])||d[a[i]]>l[d[a[j]]]))))))},isEmpty:function(a){return!(!a.match(/^\s+$/)&&""!==a)},checkTime:function(a){var b;if(!c.isEmpty(a)){if(!(b=a.match(/^(\d{1,2}):(\d{2})([apAP][Mm])?$/)))return!1;if(b[3]){if(b[1]<1||b[1]>12)return!1}else if(b[1]>23)return!1;if(b[2]>59)return!1}return!0},checkValues:function(b,d,e,g,h){var i,j,k,l,m,n=this,o=n.p,p=o.colModel,q=c.isEmpty,r=f.call(a(n),"edit.msg"),s=f.call(a(n),"formatter.date.masks");if(void 0===e){if("string"==typeof d&&(d=o.iColByName[d]),void 0===d||d<0)return[!0,"",""];l=p[d],i=l.editrules,null!=l.formoptions&&(j=l.formoptions.label)}else i=e,j=void 0===g?"_":g,l=p[d];if(i){if(j||(j=null!=o.colNames?o.colNames[d]:l.label),i.required===!0&&q(b))return[!1,j+": "+r.required,""];var t=i.required!==!1;if(i.number===!0&&(t!==!1||!q(b))&&isNaN(b))return[!1,j+": "+r.number,""];if(void 0!==i.minValue&&!isNaN(i.minValue)&&parseFloat(b)<parseFloat(i.minValue))return[!1,j+": "+r.minValue+" "+i.minValue,""];if(void 0!==i.maxValue&&!isNaN(i.maxValue)&&parseFloat(b)>parseFloat(i.maxValue))return[!1,j+": "+r.maxValue+" "+i.maxValue,""];var u;if(i.email===!0&&!(t===!1&&q(b)||(u=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,u.test(b))))return[!1,j+": "+r.email,""];if(i.integer===!0&&(t!==!1||!q(b))){if(isNaN(b))return[!1,j+": "+r.integer,""];if(b%1!=0||b.indexOf(".")!==-1)return[!1,j+": "+r.integer,""]}if(i.date===!0&&!(t===!1&&q(b)||(l.formatoptions&&l.formatoptions.newformat?(k=l.formatoptions.newformat,s.hasOwnProperty(k)&&(k=s[k])):k=p[d].datefmt||"Y-m-d",c.checkDate(k,b))))return[!1,j+": "+r.date+" - "+k,""];if(i.time===!0&&!(t===!1&&q(b)||c.checkTime(b)))return[!1,j+": "+r.date+" - hh:mm (am/pm)",""];if(i.url===!0&&!(t===!1&&q(b)||(u=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i,u.test(b))))return[!1,j+": "+r.url,""];if(i.custom===!0){if(t!==!1||!q(b))return a.isFunction(i.custom_func)?(m=i.custom_func.call(n,b,j,d),a.isArray(m)?m:[!1,r.customarray,""]):[!1,r.customfcheck,""]}else if(a.isFunction(i.custom)&&(t!==!1||!q(b)))return m=i.custom.call(n,h),a.isArray(m)?m:[!1,r.customarray,""]}return[!0,"",""]}})});
//# sourceMappingURL=grid.common.js.map